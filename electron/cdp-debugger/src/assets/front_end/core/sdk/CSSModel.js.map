{
  "version": 3,
  "sources": ["../../../../../../front_end/core/sdk/CSSModel.ts"],
  "sourcesContent": ["// Copyright 2021 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\n/*\n * Copyright (C) 2010 Google Inc. All rights reserved.\n *\n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions are\n * met:\n *\n *     * Redistributions of source code must retain the above copyright\n * notice, this list of conditions and the following disclaimer.\n *     * Redistributions in binary form must reproduce the above\n * copyright notice, this list of conditions and the following disclaimer\n * in the documentation and/or other materials provided with the\n * distribution.\n *     * Neither the #name of Google Inc. nor the names of its\n * contributors may be used to endorse or promote products derived from\n * this software without specific prior written permission.\n *\n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS\n * \"AS IS\" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT\n * LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR\n * A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT\n * OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\n * SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\n * LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY\n * THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n */\n\nimport * as TextUtils from '../../models/text_utils/text_utils.js';\nimport * as Common from '../common/common.js';\nimport * as Host from '../host/host.js';\nimport * as Platform from '../platform/platform.js';\nimport type * as ProtocolProxyApi from '../../generated/protocol-proxy-api.js';\nimport type * as Protocol from '../../generated/protocol.js';\n\nimport {CSSFontFace} from './CSSFontFace.js';\nimport {CSSMatchedStyles} from './CSSMatchedStyles.js';\nimport {CSSMedia} from './CSSMedia.js';\nimport {CSSStyleRule} from './CSSRule.js';\nimport {CSSStyleDeclaration, Type} from './CSSStyleDeclaration.js';\nimport {CSSStyleSheetHeader} from './CSSStyleSheetHeader.js';\nimport type {DOMNode} from './DOMModel.js';\nimport {DOMModel} from './DOMModel.js';\nimport type {ResourceTreeFrame} from './ResourceTreeModel.js';\nimport {Events as ResourceTreeModelEvents, ResourceTreeModel} from './ResourceTreeModel.js';\nimport type {Target} from './Target.js';\nimport {Capability} from './Target.js';\nimport {SDKModel} from './SDKModel.js';\nimport {SourceMapManager} from './SourceMapManager.js';\n\nexport class CSSModel extends SDKModel<EventTypes> {\n  readonly agent: ProtocolProxyApi.CSSApi;\n  readonly #domModel: DOMModel;\n  readonly #fontFaces: Map<string, CSSFontFace>;\n  readonly #originalStyleSheetText: Map<CSSStyleSheetHeader, Promise<string|null>>;\n  readonly #resourceTreeModel: ResourceTreeModel|null;\n  readonly #sourceMapManager: SourceMapManager<CSSStyleSheetHeader>;\n  readonly #styleLoader: ComputedStyleLoader;\n  readonly #stylePollingThrottler: Common.Throttler.Throttler;\n  readonly #styleSheetIdsForURL: Map<Platform.DevToolsPath.UrlString, Map<string, Set<Protocol.CSS.StyleSheetId>>>;\n  readonly #styleSheetIdToHeader: Map<Protocol.CSS.StyleSheetId, CSSStyleSheetHeader>;\n  #cachedMatchedCascadeNode: DOMNode|null;\n  #cachedMatchedCascadePromise: Promise<CSSMatchedStyles|null>|null;\n  #cssPropertyTracker: CSSPropertyTracker|null;\n  #isCSSPropertyTrackingEnabled: boolean;\n  #isEnabled: boolean;\n  #isRuleUsageTrackingEnabled: boolean;\n  #isTrackingRequestPending: boolean;\n\n  constructor(target: Target) {\n    super(target);\n    this.#isEnabled = false;\n    this.#cachedMatchedCascadeNode = null;\n    this.#cachedMatchedCascadePromise = null;\n    this.#domModel = (target.model(DOMModel) as DOMModel);\n    this.#sourceMapManager = new SourceMapManager(target);\n    this.agent = target.cssAgent();\n    this.#styleLoader = new ComputedStyleLoader(this);\n    this.#resourceTreeModel = target.model(ResourceTreeModel);\n    if (this.#resourceTreeModel) {\n      this.#resourceTreeModel.addEventListener(\n          ResourceTreeModelEvents.MainFrameNavigated, this.onMainFrameNavigated, this);\n    }\n    target.registerCSSDispatcher(new CSSDispatcher(this));\n    if (!target.suspended()) {\n      void this.enable();\n    }\n    this.#styleSheetIdToHeader = new Map();\n    this.#styleSheetIdsForURL = new Map();\n\n    this.#originalStyleSheetText = new Map();\n\n    this.#isRuleUsageTrackingEnabled = false;\n\n    this.#fontFaces = new Map();\n\n    this.#cssPropertyTracker = null;  // TODO: support multiple trackers when we refactor the backend\n    this.#isCSSPropertyTrackingEnabled = false;\n    this.#isTrackingRequestPending = false;\n    this.#stylePollingThrottler = new Common.Throttler.Throttler(StylePollingInterval);\n\n    this.#sourceMapManager.setEnabled(Common.Settings.Settings.instance().moduleSetting('cssSourceMapsEnabled').get());\n    Common.Settings.Settings.instance()\n        .moduleSetting('cssSourceMapsEnabled')\n        .addChangeListener(event => this.#sourceMapManager.setEnabled((event.data as boolean)));\n  }\n\n  headersForSourceURL(sourceURL: Platform.DevToolsPath.UrlString): CSSStyleSheetHeader[] {\n    const headers = [];\n    for (const headerId of this.getStyleSheetIdsForURL(sourceURL)) {\n      const header = this.styleSheetHeaderForId(headerId);\n      if (header) {\n        headers.push(header);\n      }\n    }\n    return headers;\n  }\n\n  createRawLocationsByURL(\n      sourceURL: Platform.DevToolsPath.UrlString, lineNumber: number,\n      columnNumber: number|undefined = 0): CSSLocation[] {\n    const headers = this.headersForSourceURL(sourceURL);\n    headers.sort(stylesheetComparator);\n    const endIndex = Platform.ArrayUtilities.upperBound(\n        headers, undefined, (_, header) => lineNumber - header.startLine || columnNumber - header.startColumn);\n    if (!endIndex) {\n      return [];\n    }\n    const locations = [];\n    const last = headers[endIndex - 1];\n    for (let index = endIndex - 1;\n         index >= 0 && headers[index].startLine === last.startLine && headers[index].startColumn === last.startColumn;\n         --index) {\n      if (headers[index].containsLocation(lineNumber, columnNumber)) {\n        locations.push(new CSSLocation(headers[index], lineNumber, columnNumber));\n      }\n    }\n\n    return locations;\n    function stylesheetComparator(a: CSSStyleSheetHeader, b: CSSStyleSheetHeader): number {\n      return a.startLine - b.startLine || a.startColumn - b.startColumn || a.id.localeCompare(b.id);\n    }\n  }\n\n  sourceMapManager(): SourceMapManager<CSSStyleSheetHeader> {\n    return this.#sourceMapManager;\n  }\n\n  static readableLayerName(text: string): string {\n    return text || '<anonymous>';\n  }\n\n  static trimSourceURL(text: string): string {\n    let sourceURLIndex = text.lastIndexOf('/*# sourceURL=');\n    if (sourceURLIndex === -1) {\n      sourceURLIndex = text.lastIndexOf('/*@ sourceURL=');\n      if (sourceURLIndex === -1) {\n        return text;\n      }\n    }\n    const sourceURLLineIndex = text.lastIndexOf('\\n', sourceURLIndex);\n    if (sourceURLLineIndex === -1) {\n      return text;\n    }\n    const sourceURLLine = text.substr(sourceURLLineIndex + 1).split('\\n', 1)[0];\n    const sourceURLRegex = /[\\040\\t]*\\/\\*[#@] sourceURL=[\\040\\t]*([^\\s]*)[\\040\\t]*\\*\\/[\\040\\t]*$/;\n    if (sourceURLLine.search(sourceURLRegex) === -1) {\n      return text;\n    }\n    return text.substr(0, sourceURLLineIndex) + text.substr(sourceURLLineIndex + sourceURLLine.length + 1);\n  }\n\n  domModel(): DOMModel {\n    return this.#domModel;\n  }\n\n  async setStyleText(\n      styleSheetId: Protocol.CSS.StyleSheetId, range: TextUtils.TextRange.TextRange, text: string,\n      majorChange: boolean): Promise<boolean> {\n    try {\n      await this.ensureOriginalStyleSheetText(styleSheetId);\n\n      const {styles} = await this.agent.invoke_setStyleTexts(\n          {edits: [{styleSheetId: styleSheetId, range: range.serializeToObject(), text}]});\n      if (!styles || styles.length !== 1) {\n        return false;\n      }\n\n      this.#domModel.markUndoableState(!majorChange);\n      const edit = new Edit(styleSheetId, range, text, styles[0]);\n      this.fireStyleSheetChanged(styleSheetId, edit);\n      return true;\n    } catch (e) {\n      return false;\n    }\n  }\n\n  async setSelectorText(styleSheetId: Protocol.CSS.StyleSheetId, range: TextUtils.TextRange.TextRange, text: string):\n      Promise<boolean> {\n    Host.userMetrics.actionTaken(Host.UserMetrics.Action.StyleRuleEdited);\n\n    try {\n      await this.ensureOriginalStyleSheetText(styleSheetId);\n      const {selectorList} = await this.agent.invoke_setRuleSelector({styleSheetId, range, selector: text});\n\n      if (!selectorList) {\n        return false;\n      }\n      this.#domModel.markUndoableState();\n      const edit = new Edit(styleSheetId, range, text, selectorList);\n      this.fireStyleSheetChanged(styleSheetId, edit);\n      return true;\n    } catch (e) {\n      return false;\n    }\n  }\n\n  async setKeyframeKey(styleSheetId: Protocol.CSS.StyleSheetId, range: TextUtils.TextRange.TextRange, text: string):\n      Promise<boolean> {\n    Host.userMetrics.actionTaken(Host.UserMetrics.Action.StyleRuleEdited);\n\n    try {\n      await this.ensureOriginalStyleSheetText(styleSheetId);\n      const {keyText} = await this.agent.invoke_setKeyframeKey({styleSheetId, range, keyText: text});\n\n      if (!keyText) {\n        return false;\n      }\n      this.#domModel.markUndoableState();\n      const edit = new Edit(styleSheetId, range, text, keyText);\n      this.fireStyleSheetChanged(styleSheetId, edit);\n      return true;\n    } catch (e) {\n      return false;\n    }\n  }\n\n  startCoverage(): Promise<Protocol.ProtocolResponseWithError> {\n    this.#isRuleUsageTrackingEnabled = true;\n    return this.agent.invoke_startRuleUsageTracking();\n  }\n\n  async takeCoverageDelta(): Promise<{\n    timestamp: number,\n    coverage: Array<Protocol.CSS.RuleUsage>,\n  }> {\n    const r = await this.agent.invoke_takeCoverageDelta();\n    const timestamp = (r && r.timestamp) || 0;\n    const coverage = (r && r.coverage) || [];\n    return {timestamp, coverage};\n  }\n\n  setLocalFontsEnabled(enabled: boolean): Promise<Protocol.ProtocolResponseWithError> {\n    return this.agent.invoke_setLocalFontsEnabled({\n      enabled,\n    });\n  }\n\n  async stopCoverage(): Promise<void> {\n    this.#isRuleUsageTrackingEnabled = false;\n    await this.agent.invoke_stopRuleUsageTracking();\n  }\n\n  async getMediaQueries(): Promise<CSSMedia[]> {\n    const {medias} = await this.agent.invoke_getMediaQueries();\n    return medias ? CSSMedia.parseMediaArrayPayload(this, medias) : [];\n  }\n\n  async getRootLayer(nodeId: Protocol.DOM.NodeId): Promise<Protocol.CSS.CSSLayerData> {\n    const {rootLayer} = await this.agent.invoke_getLayersForNode({nodeId});\n    return rootLayer;\n  }\n\n  isEnabled(): boolean {\n    return this.#isEnabled;\n  }\n\n  private async enable(): Promise<void> {\n    await this.agent.invoke_enable();\n    this.#isEnabled = true;\n    if (this.#isRuleUsageTrackingEnabled) {\n      await this.startCoverage();\n    }\n    this.dispatchEventToListeners(Events.ModelWasEnabled);\n  }\n\n  async getMatchedStyles(nodeId: Protocol.DOM.NodeId): Promise<CSSMatchedStyles|null> {\n    const response = await this.agent.invoke_getMatchedStylesForNode({nodeId});\n\n    if (response.getError()) {\n      return null;\n    }\n\n    const node = this.#domModel.nodeForId(nodeId);\n    if (!node) {\n      return null;\n    }\n\n    return new CSSMatchedStyles(\n        this, (node as DOMNode), response.inlineStyle || null, response.attributesStyle || null,\n        response.matchedCSSRules || [], response.pseudoElements || [], response.inherited || [],\n        response.inheritedPseudoElements || [], response.cssKeyframesRules || []);\n  }\n\n  async getClassNames(styleSheetId: Protocol.CSS.StyleSheetId): Promise<string[]> {\n    const {classNames} = await this.agent.invoke_collectClassNames({styleSheetId});\n    return classNames || [];\n  }\n\n  getComputedStyle(nodeId: Protocol.DOM.NodeId): Promise<Map<string, string>|null> {\n    return this.#styleLoader.computedStylePromise(nodeId);\n  }\n\n  async getBackgroundColors(nodeId: Protocol.DOM.NodeId): Promise<ContrastInfo|null> {\n    const response = await this.agent.invoke_getBackgroundColors({nodeId});\n    if (response.getError()) {\n      return null;\n    }\n\n    return {\n      backgroundColors: response.backgroundColors || null,\n      computedFontSize: response.computedFontSize || '',\n      computedFontWeight: response.computedFontWeight || '',\n    };\n  }\n\n  async getPlatformFonts(nodeId: Protocol.DOM.NodeId): Promise<Protocol.CSS.PlatformFontUsage[]|null> {\n    const {fonts} = await this.agent.invoke_getPlatformFontsForNode({nodeId});\n    return fonts;\n  }\n\n  allStyleSheets(): CSSStyleSheetHeader[] {\n    const values = [...this.#styleSheetIdToHeader.values()];\n    function styleSheetComparator(a: CSSStyleSheetHeader, b: CSSStyleSheetHeader): number {\n      if (a.sourceURL < b.sourceURL) {\n        return -1;\n      }\n      if (a.sourceURL > b.sourceURL) {\n        return 1;\n      }\n      return a.startLine - b.startLine || a.startColumn - b.startColumn;\n    }\n    values.sort(styleSheetComparator);\n\n    return values;\n  }\n\n  async getInlineStyles(nodeId: Protocol.DOM.NodeId): Promise<InlineStyleResult|null> {\n    const response = await this.agent.invoke_getInlineStylesForNode({nodeId});\n\n    if (response.getError() || !response.inlineStyle) {\n      return null;\n    }\n    const inlineStyle = new CSSStyleDeclaration(this, null, response.inlineStyle, Type.Inline);\n    const attributesStyle = response.attributesStyle ?\n        new CSSStyleDeclaration(this, null, response.attributesStyle, Type.Attributes) :\n        null;\n    return new InlineStyleResult(inlineStyle, attributesStyle);\n  }\n\n  forcePseudoState(node: DOMNode, pseudoClass: string, enable: boolean): boolean {\n    const forcedPseudoClasses = node.marker<string[]>(PseudoStateMarker) || [];\n    const hasPseudoClass = forcedPseudoClasses.includes(pseudoClass);\n    if (enable) {\n      if (hasPseudoClass) {\n        return false;\n      }\n      forcedPseudoClasses.push(pseudoClass);\n      node.setMarker(PseudoStateMarker, forcedPseudoClasses);\n    } else {\n      if (!hasPseudoClass) {\n        return false;\n      }\n      Platform.ArrayUtilities.removeElement(forcedPseudoClasses, pseudoClass);\n      if (forcedPseudoClasses.length) {\n        node.setMarker(PseudoStateMarker, forcedPseudoClasses);\n      } else {\n        node.setMarker(PseudoStateMarker, null);\n      }\n    }\n\n    if (node.id === undefined) {\n      return false;\n    }\n    void this.agent.invoke_forcePseudoState({nodeId: node.id, forcedPseudoClasses});\n    this.dispatchEventToListeners(Events.PseudoStateForced, {node: node, pseudoClass: pseudoClass, enable: enable});\n    return true;\n  }\n\n  pseudoState(node: DOMNode): string[]|null {\n    return node.marker(PseudoStateMarker) || [];\n  }\n\n  async setMediaText(\n      styleSheetId: Protocol.CSS.StyleSheetId, range: TextUtils.TextRange.TextRange,\n      newMediaText: string): Promise<boolean> {\n    Host.userMetrics.actionTaken(Host.UserMetrics.Action.StyleRuleEdited);\n\n    try {\n      await this.ensureOriginalStyleSheetText(styleSheetId);\n      const {media} = await this.agent.invoke_setMediaText({styleSheetId, range, text: newMediaText});\n\n      if (!media) {\n        return false;\n      }\n      this.#domModel.markUndoableState();\n      const edit = new Edit(styleSheetId, range, newMediaText, media);\n      this.fireStyleSheetChanged(styleSheetId, edit);\n      return true;\n    } catch (e) {\n      return false;\n    }\n  }\n\n  async setContainerQueryText(\n      styleSheetId: Protocol.CSS.StyleSheetId, range: TextUtils.TextRange.TextRange,\n      newContainerQueryText: string): Promise<boolean> {\n    Host.userMetrics.actionTaken(Host.UserMetrics.Action.StyleRuleEdited);\n\n    try {\n      await this.ensureOriginalStyleSheetText(styleSheetId);\n      const {containerQuery} =\n          await this.agent.invoke_setContainerQueryText({styleSheetId, range, text: newContainerQueryText});\n\n      if (!containerQuery) {\n        return false;\n      }\n      this.#domModel.markUndoableState();\n      const edit = new Edit(styleSheetId, range, newContainerQueryText, containerQuery);\n      this.fireStyleSheetChanged(styleSheetId, edit);\n      return true;\n    } catch (e) {\n      return false;\n    }\n  }\n\n  async setSupportsText(\n      styleSheetId: Protocol.CSS.StyleSheetId, range: TextUtils.TextRange.TextRange,\n      newSupportsText: string): Promise<boolean> {\n    Host.userMetrics.actionTaken(Host.UserMetrics.Action.StyleRuleEdited);\n\n    try {\n      await this.ensureOriginalStyleSheetText(styleSheetId);\n      const {supports} = await this.agent.invoke_setSupportsText({styleSheetId, range, text: newSupportsText});\n\n      if (!supports) {\n        return false;\n      }\n      this.#domModel.markUndoableState();\n      const edit = new Edit(styleSheetId, range, newSupportsText, supports);\n      this.fireStyleSheetChanged(styleSheetId, edit);\n      return true;\n    } catch (e) {\n      return false;\n    }\n  }\n\n  async addRule(styleSheetId: Protocol.CSS.StyleSheetId, ruleText: string, ruleLocation: TextUtils.TextRange.TextRange):\n      Promise<CSSStyleRule|null> {\n    try {\n      await this.ensureOriginalStyleSheetText(styleSheetId);\n      const {rule} = await this.agent.invoke_addRule({styleSheetId, ruleText, location: ruleLocation});\n\n      if (!rule) {\n        return null;\n      }\n      this.#domModel.markUndoableState();\n      const edit = new Edit(styleSheetId, ruleLocation, ruleText, rule);\n      this.fireStyleSheetChanged(styleSheetId, edit);\n      return new CSSStyleRule(this, rule);\n    } catch (e) {\n      return null;\n    }\n  }\n\n  async requestViaInspectorStylesheet(node: DOMNode): Promise<CSSStyleSheetHeader|null> {\n    const frameId = node.frameId() ||\n        (this.#resourceTreeModel && this.#resourceTreeModel.mainFrame ? this.#resourceTreeModel.mainFrame.id : null);\n    const headers = [...this.#styleSheetIdToHeader.values()];\n    const styleSheetHeader = headers.find(header => header.frameId === frameId && header.isViaInspector());\n    if (styleSheetHeader) {\n      return styleSheetHeader;\n    }\n    if (!frameId) {\n      return null;\n    }\n\n    try {\n      const {styleSheetId} = await this.agent.invoke_createStyleSheet({frameId});\n      if (!styleSheetId) {\n        return null;\n      }\n      return this.#styleSheetIdToHeader.get(styleSheetId) || null;\n    } catch (e) {\n      return null;\n    }\n  }\n\n  mediaQueryResultChanged(): void {\n    this.dispatchEventToListeners(Events.MediaQueryResultChanged);\n  }\n\n  fontsUpdated(fontFace?: Protocol.CSS.FontFace|null): void {\n    if (fontFace) {\n      this.#fontFaces.set(fontFace.src, new CSSFontFace(fontFace));\n    }\n    this.dispatchEventToListeners(Events.FontsUpdated);\n  }\n\n  fontFaces(): CSSFontFace[] {\n    return [...this.#fontFaces.values()];\n  }\n\n  fontFaceForSource(src: string): CSSFontFace|undefined {\n    return this.#fontFaces.get(src);\n  }\n\n  styleSheetHeaderForId(id: Protocol.CSS.StyleSheetId): CSSStyleSheetHeader|null {\n    return this.#styleSheetIdToHeader.get(id) || null;\n  }\n\n  styleSheetHeaders(): CSSStyleSheetHeader[] {\n    return [...this.#styleSheetIdToHeader.values()];\n  }\n\n  fireStyleSheetChanged(styleSheetId: Protocol.CSS.StyleSheetId, edit?: Edit): void {\n    this.dispatchEventToListeners(Events.StyleSheetChanged, {styleSheetId: styleSheetId, edit: edit});\n  }\n\n  private ensureOriginalStyleSheetText(styleSheetId: Protocol.CSS.StyleSheetId): Promise<string|null> {\n    const header = this.styleSheetHeaderForId(styleSheetId);\n    if (!header) {\n      return Promise.resolve(null);\n    }\n    let promise = this.#originalStyleSheetText.get(header);\n    if (!promise) {\n      promise = this.getStyleSheetText(header.id);\n      this.#originalStyleSheetText.set(header, promise);\n      this.originalContentRequestedForTest(header);\n    }\n    return promise;\n  }\n\n  private originalContentRequestedForTest(_header: CSSStyleSheetHeader): void {\n  }\n\n  originalStyleSheetText(header: CSSStyleSheetHeader): Promise<string|null> {\n    return this.ensureOriginalStyleSheetText(header.id);\n  }\n\n  getAllStyleSheetHeaders(): Iterable<CSSStyleSheetHeader> {\n    return this.#styleSheetIdToHeader.values();\n  }\n\n  styleSheetAdded(header: Protocol.CSS.CSSStyleSheetHeader): void {\n    console.assert(!this.#styleSheetIdToHeader.get(header.styleSheetId));\n    const styleSheetHeader = new CSSStyleSheetHeader(this, header);\n    this.#styleSheetIdToHeader.set(header.styleSheetId, styleSheetHeader);\n    const url = styleSheetHeader.resourceURL();\n    let frameIdToStyleSheetIds = this.#styleSheetIdsForURL.get(url);\n    if (!frameIdToStyleSheetIds) {\n      frameIdToStyleSheetIds = new Map();\n      this.#styleSheetIdsForURL.set(url, frameIdToStyleSheetIds);\n    }\n    if (frameIdToStyleSheetIds) {\n      let styleSheetIds = frameIdToStyleSheetIds.get(styleSheetHeader.frameId);\n      if (!styleSheetIds) {\n        styleSheetIds = new Set();\n        frameIdToStyleSheetIds.set(styleSheetHeader.frameId, styleSheetIds);\n      }\n      styleSheetIds.add(styleSheetHeader.id);\n    }\n    this.#sourceMapManager.attachSourceMap(styleSheetHeader, styleSheetHeader.sourceURL, styleSheetHeader.sourceMapURL);\n    this.dispatchEventToListeners(Events.StyleSheetAdded, styleSheetHeader);\n  }\n\n  styleSheetRemoved(id: Protocol.CSS.StyleSheetId): void {\n    const header = this.#styleSheetIdToHeader.get(id);\n    console.assert(Boolean(header));\n    if (!header) {\n      return;\n    }\n    this.#styleSheetIdToHeader.delete(id);\n    const url = header.resourceURL();\n    const frameIdToStyleSheetIds = this.#styleSheetIdsForURL.get(url);\n    console.assert(\n        Boolean(frameIdToStyleSheetIds), 'No frameId to styleSheetId map is available for given style sheet URL.');\n    if (frameIdToStyleSheetIds) {\n      const stylesheetIds = frameIdToStyleSheetIds.get(header.frameId);\n      if (stylesheetIds) {\n        stylesheetIds.delete(id);\n        if (!stylesheetIds.size) {\n          frameIdToStyleSheetIds.delete(header.frameId);\n          if (!frameIdToStyleSheetIds.size) {\n            this.#styleSheetIdsForURL.delete(url);\n          }\n        }\n      }\n    }\n    this.#originalStyleSheetText.delete(header);\n    this.#sourceMapManager.detachSourceMap(header);\n    this.dispatchEventToListeners(Events.StyleSheetRemoved, header);\n  }\n\n  getStyleSheetIdsForURL(url: Platform.DevToolsPath.UrlString): Protocol.CSS.StyleSheetId[] {\n    const frameIdToStyleSheetIds = this.#styleSheetIdsForURL.get(url);\n    if (!frameIdToStyleSheetIds) {\n      return [];\n    }\n\n    const result = [];\n    for (const styleSheetIds of frameIdToStyleSheetIds.values()) {\n      result.push(...styleSheetIds);\n    }\n    return result;\n  }\n\n  async setStyleSheetText(styleSheetId: Protocol.CSS.StyleSheetId, newText: string, majorChange: boolean):\n      Promise<string|null> {\n    const header = this.#styleSheetIdToHeader.get(styleSheetId);\n    if (!header) {\n      return 'Unknown stylesheet in CSS.setStyleSheetText';\n    }\n    newText = CSSModel.trimSourceURL(newText);\n    if (header.hasSourceURL) {\n      newText += '\\n/*# sourceURL=' + header.sourceURL + ' */';\n    }\n\n    await this.ensureOriginalStyleSheetText(styleSheetId);\n    const response = await this.agent.invoke_setStyleSheetText({styleSheetId: header.id, text: newText});\n    const sourceMapURL = response.sourceMapURL as Platform.DevToolsPath.UrlString;\n\n    this.#sourceMapManager.detachSourceMap(header);\n    header.setSourceMapURL(sourceMapURL);\n    this.#sourceMapManager.attachSourceMap(header, header.sourceURL, header.sourceMapURL);\n    if (sourceMapURL === null) {\n      return 'Error in CSS.setStyleSheetText';\n    }\n    this.#domModel.markUndoableState(!majorChange);\n    this.fireStyleSheetChanged(styleSheetId);\n    return null;\n  }\n\n  async getStyleSheetText(styleSheetId: Protocol.CSS.StyleSheetId): Promise<string|null> {\n    try {\n      const {text} = await this.agent.invoke_getStyleSheetText({styleSheetId});\n      return text && CSSModel.trimSourceURL(text);\n    } catch (e) {\n      return null;\n    }\n  }\n\n  private async onMainFrameNavigated(event: Common.EventTarget.EventTargetEvent<ResourceTreeFrame>): Promise<void> {\n    // If the main frame was restored from the back-forward cache, the order of CDP\n    // is different from the regular navigations. In this case, events about CSS\n    // stylesheet has already been received and they are mixed with the previous page\n    // stylesheets. Therefore, we re-enable the CSS agent to get fresh events.\n    // For the regular navigatons, we can just clear the local data because events about\n    // stylesheets will arrive later.\n    if (event.data.backForwardCacheDetails.restoredFromCache) {\n      await this.suspendModel();\n      await this.resumeModel();\n    } else {\n      this.resetStyleSheets();\n      this.resetFontFaces();\n    }\n  }\n\n  private resetStyleSheets(): void {\n    const headers = [...this.#styleSheetIdToHeader.values()];\n    this.#styleSheetIdsForURL.clear();\n    this.#styleSheetIdToHeader.clear();\n    for (const header of headers) {\n      this.#sourceMapManager.detachSourceMap(header);\n      this.dispatchEventToListeners(Events.StyleSheetRemoved, header);\n    }\n  }\n\n  private resetFontFaces(): void {\n    this.#fontFaces.clear();\n  }\n\n  async suspendModel(): Promise<void> {\n    this.#isEnabled = false;\n    await this.agent.invoke_disable();\n    this.resetStyleSheets();\n    this.resetFontFaces();\n  }\n\n  async resumeModel(): Promise<void> {\n    return this.enable();\n  }\n\n  setEffectivePropertyValueForNode(nodeId: Protocol.DOM.NodeId, propertyName: string, value: string): void {\n    void this.agent.invoke_setEffectivePropertyValueForNode({nodeId, propertyName, value});\n  }\n\n  cachedMatchedCascadeForNode(node: DOMNode): Promise<CSSMatchedStyles|null> {\n    if (this.#cachedMatchedCascadeNode !== node) {\n      this.discardCachedMatchedCascade();\n    }\n    this.#cachedMatchedCascadeNode = node;\n    if (!this.#cachedMatchedCascadePromise) {\n      if (node.id) {\n        this.#cachedMatchedCascadePromise = this.getMatchedStyles(node.id);\n      } else {\n        return Promise.resolve(null);\n      }\n    }\n    return this.#cachedMatchedCascadePromise;\n  }\n\n  discardCachedMatchedCascade(): void {\n    this.#cachedMatchedCascadeNode = null;\n    this.#cachedMatchedCascadePromise = null;\n  }\n\n  createCSSPropertyTracker(propertiesToTrack: Protocol.CSS.CSSComputedStyleProperty[]): CSSPropertyTracker {\n    const cssPropertyTracker = new CSSPropertyTracker(this, propertiesToTrack);\n    return cssPropertyTracker;\n  }\n\n  enableCSSPropertyTracker(cssPropertyTracker: CSSPropertyTracker): void {\n    const propertiesToTrack = cssPropertyTracker.getTrackedProperties();\n    if (propertiesToTrack.length === 0) {\n      return;\n    }\n    void this.agent.invoke_trackComputedStyleUpdates({propertiesToTrack});\n    this.#isCSSPropertyTrackingEnabled = true;\n    this.#cssPropertyTracker = cssPropertyTracker;\n    void this.pollComputedStyleUpdates();\n  }\n\n  // Since we only support one tracker at a time, this call effectively disables\n  // style tracking.\n  disableCSSPropertyTracker(): void {\n    this.#isCSSPropertyTrackingEnabled = false;\n    this.#cssPropertyTracker = null;\n    // Sending an empty list to the backend signals the close of style tracking\n    void this.agent.invoke_trackComputedStyleUpdates({propertiesToTrack: []});\n  }\n\n  private async pollComputedStyleUpdates(): Promise<void> {\n    if (this.#isTrackingRequestPending) {\n      return;\n    }\n\n    if (this.#isCSSPropertyTrackingEnabled) {\n      this.#isTrackingRequestPending = true;\n      const result = await this.agent.invoke_takeComputedStyleUpdates();\n      this.#isTrackingRequestPending = false;\n\n      if (result.getError() || !result.nodeIds || !this.#isCSSPropertyTrackingEnabled) {\n        return;\n      }\n\n      if (this.#cssPropertyTracker) {\n        this.#cssPropertyTracker.dispatchEventToListeners(\n            CSSPropertyTrackerEvents.TrackedCSSPropertiesUpdated,\n            result.nodeIds.map(nodeId => this.#domModel.nodeForId(nodeId)));\n      }\n    }\n\n    if (this.#isCSSPropertyTrackingEnabled) {\n      void this.#stylePollingThrottler.schedule(this.pollComputedStyleUpdates.bind(this));\n    }\n  }\n\n  dispose(): void {\n    this.disableCSSPropertyTracker();\n    super.dispose();\n    this.#sourceMapManager.dispose();\n  }\n\n  getAgent(): ProtocolProxyApi.CSSApi {\n    return this.agent;\n  }\n}\n\n// TODO(crbug.com/1167717): Make this a const enum again\n// eslint-disable-next-line rulesdir/const_enum\nexport enum Events {\n  FontsUpdated = 'FontsUpdated',\n  MediaQueryResultChanged = 'MediaQueryResultChanged',\n  ModelWasEnabled = 'ModelWasEnabled',\n  PseudoStateForced = 'PseudoStateForced',\n  StyleSheetAdded = 'StyleSheetAdded',\n  StyleSheetChanged = 'StyleSheetChanged',\n  StyleSheetRemoved = 'StyleSheetRemoved',\n}\n\nexport interface StyleSheetChangedEvent {\n  styleSheetId: Protocol.CSS.StyleSheetId;\n  edit?: Edit;\n}\n\nexport interface PseudoStateForcedEvent {\n  node: DOMNode;\n  pseudoClass: string;\n  enable: boolean;\n}\n\nexport type EventTypes = {\n  [Events.FontsUpdated]: void,\n  [Events.MediaQueryResultChanged]: void,\n  [Events.ModelWasEnabled]: void,\n  [Events.PseudoStateForced]: PseudoStateForcedEvent,\n  [Events.StyleSheetAdded]: CSSStyleSheetHeader,\n  [Events.StyleSheetChanged]: StyleSheetChangedEvent,\n  [Events.StyleSheetRemoved]: CSSStyleSheetHeader,\n};\n\nconst PseudoStateMarker = 'pseudo-state-marker';\n\nexport class Edit {\n  styleSheetId: string;\n  oldRange: TextUtils.TextRange.TextRange;\n  newRange: TextUtils.TextRange.TextRange;\n  newText: string;\n  payload: Object|null;\n  constructor(styleSheetId: string, oldRange: TextUtils.TextRange.TextRange, newText: string, payload: Object|null) {\n    this.styleSheetId = styleSheetId;\n    this.oldRange = oldRange;\n    this.newRange = TextUtils.TextRange.TextRange.fromEdit(oldRange, newText);\n    this.newText = newText;\n    this.payload = payload;\n  }\n}\n\nexport class CSSLocation {\n  readonly #cssModelInternal: CSSModel;\n  styleSheetId: Protocol.CSS.StyleSheetId;\n  url: Platform.DevToolsPath.UrlString;\n  lineNumber: number;\n  columnNumber: number;\n  constructor(header: CSSStyleSheetHeader, lineNumber: number, columnNumber?: number) {\n    this.#cssModelInternal = header.cssModel();\n    this.styleSheetId = header.id;\n    this.url = header.resourceURL();\n    this.lineNumber = lineNumber;\n    this.columnNumber = columnNumber || 0;\n  }\n\n  cssModel(): CSSModel {\n    return this.#cssModelInternal;\n  }\n\n  header(): CSSStyleSheetHeader|null {\n    return this.#cssModelInternal.styleSheetHeaderForId(this.styleSheetId);\n  }\n}\n\nclass CSSDispatcher implements ProtocolProxyApi.CSSDispatcher {\n  readonly #cssModel: CSSModel;\n  constructor(cssModel: CSSModel) {\n    this.#cssModel = cssModel;\n  }\n\n  mediaQueryResultChanged(): void {\n    this.#cssModel.mediaQueryResultChanged();\n  }\n\n  fontsUpdated({font}: Protocol.CSS.FontsUpdatedEvent): void {\n    this.#cssModel.fontsUpdated(font);\n  }\n\n  styleSheetChanged({styleSheetId}: Protocol.CSS.StyleSheetChangedEvent): void {\n    this.#cssModel.fireStyleSheetChanged(styleSheetId);\n  }\n\n  styleSheetAdded({header}: Protocol.CSS.StyleSheetAddedEvent): void {\n    this.#cssModel.styleSheetAdded(header);\n  }\n\n  styleSheetRemoved({styleSheetId}: Protocol.CSS.StyleSheetRemovedEvent): void {\n    this.#cssModel.styleSheetRemoved(styleSheetId);\n  }\n}\n\nclass ComputedStyleLoader {\n  #cssModel: CSSModel;\n  #nodeIdToPromise: Map<number, Promise<Map<string, string>|null>>;\n  constructor(cssModel: CSSModel) {\n    this.#cssModel = cssModel;\n    this.#nodeIdToPromise = new Map();\n  }\n\n  computedStylePromise(nodeId: Protocol.DOM.NodeId): Promise<Map<string, string>|null> {\n    let promise = this.#nodeIdToPromise.get(nodeId);\n    if (promise) {\n      return promise;\n    }\n    promise = this.#cssModel.getAgent().invoke_getComputedStyleForNode({nodeId}).then(({computedStyle}) => {\n      this.#nodeIdToPromise.delete(nodeId);\n      if (!computedStyle || !computedStyle.length) {\n        return null;\n      }\n      const result = new Map<string, string>();\n      for (const property of computedStyle) {\n        result.set(property.name, property.value);\n      }\n      return result;\n    });\n    this.#nodeIdToPromise.set(nodeId, promise);\n    return promise;\n  }\n}\n\nexport class InlineStyleResult {\n  inlineStyle: CSSStyleDeclaration|null;\n  attributesStyle: CSSStyleDeclaration|null;\n  constructor(inlineStyle: CSSStyleDeclaration|null, attributesStyle: CSSStyleDeclaration|null) {\n    this.inlineStyle = inlineStyle;\n    this.attributesStyle = attributesStyle;\n  }\n}\n\nexport class CSSPropertyTracker extends Common.ObjectWrapper.ObjectWrapper<CSSPropertyTrackerEventTypes> {\n  readonly #cssModel: CSSModel;\n  readonly #properties: Protocol.CSS.CSSComputedStyleProperty[];\n  constructor(cssModel: CSSModel, propertiesToTrack: Protocol.CSS.CSSComputedStyleProperty[]) {\n    super();\n    this.#cssModel = cssModel;\n    this.#properties = propertiesToTrack;\n  }\n\n  start(): void {\n    this.#cssModel.enableCSSPropertyTracker(this);\n  }\n\n  stop(): void {\n    this.#cssModel.disableCSSPropertyTracker();\n  }\n\n  getTrackedProperties(): Protocol.CSS.CSSComputedStyleProperty[] {\n    return this.#properties;\n  }\n}\n\nconst StylePollingInterval = 1000;  // throttling interval for style polling, in milliseconds\n\n// TODO(crbug.com/1167717): Make this a const enum again\n// eslint-disable-next-line rulesdir/const_enum\nexport enum CSSPropertyTrackerEvents {\n  TrackedCSSPropertiesUpdated = 'TrackedCSSPropertiesUpdated',\n}\n\nexport type CSSPropertyTrackerEventTypes = {\n  [CSSPropertyTrackerEvents.TrackedCSSPropertiesUpdated]: (DOMNode|null)[],\n};\n\nSDKModel.register(CSSModel, {capabilities: Capability.DOM, autostart: true});\nexport interface ContrastInfo {\n  backgroundColors: string[]|null;\n  computedFontSize: string;\n  computedFontWeight: string;\n}\n"],
  "mappings": "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",
  "names": []
}
