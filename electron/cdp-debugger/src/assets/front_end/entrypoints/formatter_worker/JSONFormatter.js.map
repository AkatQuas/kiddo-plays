{
  "version": 3,
  "sources": ["../../../../../../front_end/entrypoints/formatter_worker/JSONFormatter.ts"],
  "sourcesContent": ["// Copyright 2021 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport type {FormattedContentBuilder} from './FormattedContentBuilder.js';\nimport {createTokenizer} from './FormatterWorker.js';\n\nexport class JSONFormatter {\n  builder: FormattedContentBuilder;\n  toOffset!: number;\n  fromOffset!: number;\n  lineEndings!: number[];\n  lastLine: number;\n  text!: string;\n  constructor(builder: FormattedContentBuilder) {\n    this.builder = builder;\n    this.lastLine = -1;\n  }\n\n  format(text: string, lineEndings: number[], fromOffset: number, toOffset: number): void {\n    this.lineEndings = lineEndings;\n    this.fromOffset = fromOffset;\n    this.toOffset = toOffset;\n    this.lastLine = -1;\n    this.text = text;\n    const tokenize = createTokenizer('application/json');\n    tokenize(text.substring(this.fromOffset, this.toOffset), this.tokenCallback.bind(this));\n  }\n\n  tokenCallback(token: string, type: string|null, startPosition: number): void {\n    switch (token.charAt(0)) {\n      case '{':\n      case '[':\n        if (this.text[startPosition + 1] === '}' || this.text[startPosition + 1] === ']') {\n          this.builder.addToken(token, startPosition);\n        } else {\n          this.builder.addToken(token, startPosition);\n          this.builder.addNewLine();\n          this.builder.increaseNestingLevel();\n        }\n        break;\n      case '}':\n      case ']':\n        if (this.text[startPosition - 1] === '{' || this.text[startPosition - 1] === '[') {\n          this.builder.addToken(token, startPosition);\n        } else {\n          this.builder.decreaseNestingLevel();\n          this.builder.addNewLine();\n          this.builder.addToken(token, startPosition);\n        }\n        break;\n      case ':':\n        this.builder.addToken(token, startPosition);\n        this.builder.addSoftSpace();\n        break;\n      case ',':\n        this.builder.addToken(token, startPosition);\n        this.builder.addNewLine();\n        break;\n      case '':\n      case ' ':\n      case '\\n':\n        break;\n      default:\n        this.builder.addToken(token, startPosition);\n        break;\n    }\n  }\n}\n"],
  "mappings": "AAKA;AAEO,2BAAoB;AAAA,EACzB;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA,YAAY,SAAkC;AAC5C,SAAK,UAAU;AACf,SAAK,WAAW;AAAA;AAAA,EAGlB,OAAO,MAAc,aAAuB,YAAoB,UAAwB;AACtF,SAAK,cAAc;AACnB,SAAK,aAAa;AAClB,SAAK,WAAW;AAChB,SAAK,WAAW;AAChB,SAAK,OAAO;AACZ,UAAM,WAAW,gBAAgB;AACjC,aAAS,KAAK,UAAU,KAAK,YAAY,KAAK,WAAW,KAAK,cAAc,KAAK;AAAA;AAAA,EAGnF,cAAc,OAAe,MAAmB,eAA6B;AAC3E,YAAQ,MAAM,OAAO;AAAA,WACd;AAAA,WACA;AACH,YAAI,KAAK,KAAK,gBAAgB,OAAO,OAAO,KAAK,KAAK,gBAAgB,OAAO,KAAK;AAChF,eAAK,QAAQ,SAAS,OAAO;AAAA,eACxB;AACL,eAAK,QAAQ,SAAS,OAAO;AAC7B,eAAK,QAAQ;AACb,eAAK,QAAQ;AAAA;AAEf;AAAA,WACG;AAAA,WACA;AACH,YAAI,KAAK,KAAK,gBAAgB,OAAO,OAAO,KAAK,KAAK,gBAAgB,OAAO,KAAK;AAChF,eAAK,QAAQ,SAAS,OAAO;AAAA,eACxB;AACL,eAAK,QAAQ;AACb,eAAK,QAAQ;AACb,eAAK,QAAQ,SAAS,OAAO;AAAA;AAE/B;AAAA,WACG;AACH,aAAK,QAAQ,SAAS,OAAO;AAC7B,aAAK,QAAQ;AACb;AAAA,WACG;AACH,aAAK,QAAQ,SAAS,OAAO;AAC7B,aAAK,QAAQ;AACb;AAAA,WACG;AAAA,WACA;AAAA,WACA;AACH;AAAA;AAEA,aAAK,QAAQ,SAAS,OAAO;AAC7B;AAAA;AAAA;AAAA;",
  "names": []
}
