{
  "version": 3,
  "sources": ["../../../../../../front_end/ui/legacy/TextPrompt.ts"],
  "sourcesContent": ["// Copyright 2021 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\n/*\n * Copyright (C) 2008 Apple Inc.  All rights reserved.\n * Copyright (C) 2011 Google Inc.  All rights reserved.\n *\n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions\n * are met:\n *\n * 1.  Redistributions of source code must retain the above copyright\n *     notice, this list of conditions and the following disclaimer.\n * 2.  Redistributions in binary form must reproduce the above copyright\n *     notice, this list of conditions and the following disclaimer in the\n *     documentation and/or other materials provided with the distribution.\n * 3.  Neither the name of Apple Computer, Inc. (\"Apple\") nor the names of\n *     its contributors may be used to endorse or promote products derived\n *     from this software without specific prior written permission.\n *\n * THIS SOFTWARE IS PROVIDED BY APPLE AND ITS CONTRIBUTORS \"AS IS\" AND ANY\n * EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\n * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\n * DISCLAIMED. IN NO EVENT SHALL APPLE OR ITS CONTRIBUTORS BE LIABLE FOR ANY\n * DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES\n * (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;\n * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND\n * ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF\n * THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n */\n\nimport * as Common from '../../core/common/common.js';\nimport * as DOMExtension from '../../core/dom_extension/dom_extension.js';\nimport * as Platform from '../../core/platform/platform.js';\nimport * as TextUtils from '../../models/text_utils/text_utils.js';\n\nimport * as ARIAUtils from './ARIAUtils.js';\nimport * as ThemeSupport from './theme_support/theme_support.js';\n\nimport type {SuggestBoxDelegate, Suggestion} from './SuggestBox.js';\nimport {SuggestBox} from './SuggestBox.js';\nimport {Tooltip} from './Tooltip.js';\nimport {ElementFocusRestorer} from './UIUtils.js';\nimport textPromptStyles from './textPrompt.css.legacy.js';\n\nexport class TextPrompt extends Common.ObjectWrapper.ObjectWrapper<EventTypes> implements SuggestBoxDelegate {\n  private proxyElement!: HTMLElement|undefined;\n  private proxyElementDisplay: string;\n  private autocompletionTimeout: number;\n  private titleInternal: string;\n  private queryRange: TextUtils.TextRange.TextRange|null;\n  private previousText: string;\n  private currentSuggestion: Suggestion|null;\n  private completionRequestId: number;\n  private ghostTextElement: HTMLSpanElement;\n  private leftParenthesesIndices: number[];\n  private loadCompletions!: (this: null, arg1: string, arg2: string, arg3?: boolean|undefined) => Promise<Suggestion[]>;\n  private completionStopCharacters!: string;\n  private usesSuggestionBuilder!: boolean;\n  private elementInternal?: Element;\n  private boundOnKeyDown?: ((ev: Event) => void);\n  private boundOnInput?: ((ev: Event) => void);\n  private boundOnMouseWheel?: ((event: Event) => void);\n  private boundClearAutocomplete?: (() => void);\n  private contentElement?: HTMLElement;\n  private suggestBox?: SuggestBox;\n  private isEditing?: boolean;\n  private focusRestorer?: ElementFocusRestorer;\n  private blurListener?: ((arg0: Event) => void);\n  private oldTabIndex?: number;\n  private completeTimeout?: number;\n  private disableDefaultSuggestionForEmptyInputInternal?: boolean;\n\n  constructor() {\n    super();\n    this.proxyElementDisplay = 'inline-block';\n    this.autocompletionTimeout = DefaultAutocompletionTimeout;\n    this.titleInternal = '';\n    this.queryRange = null;\n    this.previousText = '';\n    this.currentSuggestion = null;\n    this.completionRequestId = 0;\n    this.ghostTextElement = document.createElement('span');\n    this.ghostTextElement.classList.add('auto-complete-text');\n    this.ghostTextElement.setAttribute('contenteditable', 'false');\n    this.leftParenthesesIndices = [];\n    ARIAUtils.markAsHidden(this.ghostTextElement);\n  }\n\n  initialize(\n      completions: (this: null, arg1: string, arg2: string, arg3?: boolean|undefined) => Promise<Suggestion[]>,\n      stopCharacters?: string, usesSuggestionBuilder?: boolean): void {\n    this.loadCompletions = completions;\n    this.completionStopCharacters = stopCharacters || ' =:[({;,!+-*/&|^<>.';\n    this.usesSuggestionBuilder = usesSuggestionBuilder || false;\n  }\n\n  setAutocompletionTimeout(timeout: number): void {\n    this.autocompletionTimeout = timeout;\n  }\n\n  renderAsBlock(): void {\n    this.proxyElementDisplay = 'block';\n  }\n\n  /**\n   * Clients should never attach any event listeners to the |element|. Instead,\n   * they should use the result of this method to attach listeners for bubbling events.\n   */\n  attach(element: Element): Element {\n    return this.attachInternal(element);\n  }\n\n  /**\n   * Clients should never attach any event listeners to the |element|. Instead,\n   * they should use the result of this method to attach listeners for bubbling events\n   * or the |blurListener| parameter to register a \"blur\" event listener on the |element|\n   * (since the \"blur\" event does not bubble.)\n   */\n  attachAndStartEditing(element: Element, blurListener: (arg0: Event) => void): Element {\n    const proxyElement = this.attachInternal(element);\n    this.startEditing(blurListener);\n    return proxyElement;\n  }\n\n  private attachInternal(element: Element): Element {\n    if (this.proxyElement) {\n      throw 'Cannot attach an attached TextPrompt';\n    }\n    this.elementInternal = element;\n\n    this.boundOnKeyDown = this.onKeyDown.bind(this);\n    this.boundOnInput = this.onInput.bind(this);\n    this.boundOnMouseWheel = this.onMouseWheel.bind(this);\n    this.boundClearAutocomplete = this.clearAutocomplete.bind(this);\n    this.proxyElement = element.ownerDocument.createElement('span');\n    ThemeSupport.ThemeSupport.instance().appendStyle(this.proxyElement, textPromptStyles);\n    this.contentElement = this.proxyElement.createChild('div', 'text-prompt-root');\n    this.proxyElement.style.display = this.proxyElementDisplay;\n    if (element.parentElement) {\n      element.parentElement.insertBefore(this.proxyElement, element);\n    }\n    this.contentElement.appendChild(element);\n    this.elementInternal.classList.add('text-prompt');\n    ARIAUtils.markAsTextBox(this.elementInternal);\n    ARIAUtils.setAutocomplete(this.elementInternal, ARIAUtils.AutocompleteInteractionModel.both);\n    ARIAUtils.setHasPopup(this.elementInternal, ARIAUtils.PopupRole.ListBox);\n    this.elementInternal.setAttribute('contenteditable', 'plaintext-only');\n    this.element().addEventListener('keydown', this.boundOnKeyDown, false);\n    this.elementInternal.addEventListener('input', this.boundOnInput, false);\n    this.elementInternal.addEventListener('wheel', this.boundOnMouseWheel, false);\n    this.elementInternal.addEventListener('selectstart', this.boundClearAutocomplete, false);\n    this.elementInternal.addEventListener('blur', this.boundClearAutocomplete, false);\n\n    this.suggestBox = new SuggestBox(this, 20);\n\n    if (this.titleInternal) {\n      Tooltip.install(this.proxyElement, this.titleInternal);\n    }\n\n    return this.proxyElement;\n  }\n\n  element(): HTMLElement {\n    if (!this.elementInternal) {\n      throw new Error('Expected an already attached element!');\n    }\n    return this.elementInternal as HTMLElement;\n  }\n\n  detach(): void {\n    this.removeFromElement();\n    if (this.focusRestorer) {\n      this.focusRestorer.restore();\n    }\n    if (this.proxyElement && this.proxyElement.parentElement) {\n      this.proxyElement.parentElement.insertBefore(this.element(), this.proxyElement);\n      this.proxyElement.remove();\n    }\n    delete this.proxyElement;\n    this.element().classList.remove('text-prompt');\n    this.element().removeAttribute('contenteditable');\n    this.element().removeAttribute('role');\n    ARIAUtils.clearAutocomplete(this.element());\n    ARIAUtils.setHasPopup(this.element(), ARIAUtils.PopupRole.False);\n  }\n\n  textWithCurrentSuggestion(): string {\n    const text = this.text();\n    if (!this.queryRange || !this.currentSuggestion) {\n      return text;\n    }\n    const suggestion = this.currentSuggestion.text;\n    return text.substring(0, this.queryRange.startColumn) + suggestion + text.substring(this.queryRange.endColumn);\n  }\n\n  text(): string {\n    let text: string = this.element().textContent || '';\n    if (this.ghostTextElement.parentNode) {\n      const addition = this.ghostTextElement.textContent || '';\n      text = text.substring(0, text.length - addition.length);\n    }\n    return text;\n  }\n\n  setText(text: string): void {\n    this.clearAutocomplete();\n    this.element().textContent = text;\n    this.previousText = this.text();\n    if (this.element().hasFocus()) {\n      this.moveCaretToEndOfPrompt();\n      this.element().scrollIntoView();\n    }\n  }\n\n  setSelectedRange(startIndex: number, endIndex: number): void {\n    if (startIndex < 0) {\n      throw new RangeError('Selected range start must be a nonnegative integer');\n    }\n    const textContent = this.element().textContent;\n    const textContentLength = textContent ? textContent.length : 0;\n    if (endIndex > textContentLength) {\n      endIndex = textContentLength;\n    }\n    if (endIndex < startIndex) {\n      endIndex = startIndex;\n    }\n\n    const textNode = (this.element().childNodes[0] as Node);\n    const range = new Range();\n    range.setStart(textNode, startIndex);\n    range.setEnd(textNode, endIndex);\n    const selection = window.getSelection();\n    if (selection) {\n      selection.removeAllRanges();\n      selection.addRange(range);\n    }\n  }\n\n  focus(): void {\n    this.element().focus();\n  }\n\n  title(): string {\n    return this.titleInternal;\n  }\n\n  setTitle(title: string): void {\n    this.titleInternal = title;\n    if (this.proxyElement) {\n      Tooltip.install(this.proxyElement, title);\n    }\n  }\n\n  setPlaceholder(placeholder: string, ariaPlaceholder?: string): void {\n    if (placeholder) {\n      this.element().setAttribute('data-placeholder', placeholder);\n      // TODO(https://github.com/nvaccess/nvda/issues/10164): Remove ariaPlaceholder once the NVDA bug is fixed\n      // ariaPlaceholder and placeholder may differ, like in case the placeholder contains a '?'\n      ARIAUtils.setPlaceholder(this.element(), ariaPlaceholder || placeholder);\n    } else {\n      this.element().removeAttribute('data-placeholder');\n      ARIAUtils.setPlaceholder(this.element(), null);\n    }\n  }\n\n  setEnabled(enabled: boolean): void {\n    if (enabled) {\n      this.element().setAttribute('contenteditable', 'plaintext-only');\n    } else {\n      this.element().removeAttribute('contenteditable');\n    }\n    this.element().classList.toggle('disabled', !enabled);\n  }\n\n  private removeFromElement(): void {\n    this.clearAutocomplete();\n    this.element().removeEventListener(\n        'keydown', (this.boundOnKeyDown as (this: HTMLElement, arg1: Event) => void), false);\n    this.element().removeEventListener('input', (this.boundOnInput as (this: HTMLElement, arg1: Event) => void), false);\n    this.element().removeEventListener(\n        'selectstart', (this.boundClearAutocomplete as (this: HTMLElement, arg1: Event) => void), false);\n    this.element().removeEventListener(\n        'blur', (this.boundClearAutocomplete as (this: HTMLElement, arg1: Event) => void), false);\n    if (this.isEditing) {\n      this.stopEditing();\n    }\n    if (this.suggestBox) {\n      this.suggestBox.hide();\n    }\n  }\n\n  private startEditing(blurListener?: ((arg0: Event) => void)): void {\n    this.isEditing = true;\n    if (this.contentElement) {\n      this.contentElement.classList.add('text-prompt-editing');\n    }\n    this.focusRestorer = new ElementFocusRestorer(this.element());\n    if (blurListener) {\n      this.blurListener = blurListener;\n      this.element().addEventListener('blur', this.blurListener, false);\n    }\n    this.oldTabIndex = this.element().tabIndex;\n    if (this.element().tabIndex < 0) {\n      this.element().tabIndex = 0;\n    }\n    if (!this.text()) {\n      this.autoCompleteSoon();\n    }\n  }\n\n  private stopEditing(): void {\n    this.element().tabIndex = (this.oldTabIndex as number);\n    if (this.blurListener) {\n      this.element().removeEventListener('blur', this.blurListener, false);\n    }\n    if (this.contentElement) {\n      this.contentElement.classList.remove('text-prompt-editing');\n    }\n    delete this.isEditing;\n  }\n\n  onMouseWheel(_event: Event): void {\n    // Subclasses can implement.\n  }\n\n  onKeyDown(ev: Event): void {\n    let handled = false;\n    const event = (ev as KeyboardEvent);\n    if (this.isSuggestBoxVisible() && this.suggestBox && this.suggestBox.keyPressed(event)) {\n      event.consume(true);\n      return;\n    }\n\n    switch (event.key) {\n      case 'Tab':\n        handled = this.tabKeyPressed(event);\n        break;\n      case 'ArrowLeft':\n      case 'ArrowUp':\n      case 'PageUp':\n      case 'Home':\n        this.clearAutocomplete();\n        break;\n      case 'PageDown':\n      case 'ArrowRight':\n      case 'ArrowDown':\n      case 'End':\n        if (this.isCaretAtEndOfPrompt()) {\n          handled = this.acceptAutoComplete();\n        } else {\n          this.clearAutocomplete();\n        }\n        break;\n      case 'Escape':\n        if (this.isSuggestBoxVisible()) {\n          this.clearAutocomplete();\n          handled = true;\n        }\n        break;\n      case ' ':  // Space\n        if (event.ctrlKey && !event.metaKey && !event.altKey && !event.shiftKey) {\n          this.autoCompleteSoon(true);\n          handled = true;\n        }\n        break;\n    }\n\n    if (event.key === 'Enter') {\n      event.preventDefault();\n    }\n\n    if (handled) {\n      event.consume(true);\n    }\n  }\n\n  private acceptSuggestionOnStopCharacters(key: string): boolean {\n    if (!this.currentSuggestion || !this.queryRange || key.length !== 1 || !this.completionStopCharacters ||\n        !this.completionStopCharacters.includes(key)) {\n      return false;\n    }\n\n    const query = this.text().substring(this.queryRange.startColumn, this.queryRange.endColumn);\n    if (query && this.currentSuggestion.text.startsWith(query + key)) {\n      this.queryRange.endColumn += 1;\n      return this.acceptAutoComplete();\n    }\n    return false;\n  }\n\n  onInput(ev: Event): void {\n    const event = (ev as InputEvent);\n    let text = this.text();\n    const currentEntry = event.data;\n\n    if (event.inputType === 'insertFromPaste' && text.includes('\\n')) {\n      /* Ensure that we remove any linebreaks from copied/pasted content\n       * to avoid breaking the rendering of the filter bar.\n       * See crbug.com/849563.\n       * We don't let users enter linebreaks when\n       * typing manually, so we should escape them if copying text in.\n       */\n      text = Platform.StringUtilities.stripLineBreaks(text);\n      this.setText(text);\n    }\n\n    // Skip the current ')' entry if the caret is right before a ')' and there's an unmatched '('.\n    const caretPosition = this.getCaretPosition();\n    if (currentEntry === ')' && caretPosition >= 0 && this.leftParenthesesIndices.length > 0) {\n      const nextCharAtCaret = text[caretPosition];\n      if (nextCharAtCaret === ')' && this.tryMatchingLeftParenthesis(caretPosition)) {\n        text = text.substring(0, caretPosition) + text.substring(caretPosition + 1);\n        this.setText(text);\n        return;\n      }\n    }\n\n    if (currentEntry && !this.acceptSuggestionOnStopCharacters(currentEntry)) {\n      const hasCommonPrefix = text.startsWith(this.previousText) || this.previousText.startsWith(text);\n      if (this.queryRange && hasCommonPrefix) {\n        this.queryRange.endColumn += text.length - this.previousText.length;\n      }\n    }\n    this.refreshGhostText();\n    this.previousText = text;\n    this.dispatchEventToListeners(Events.TextChanged);\n\n    this.autoCompleteSoon();\n  }\n\n  acceptAutoComplete(): boolean {\n    let result = false;\n    if (this.isSuggestBoxVisible() && this.suggestBox) {\n      result = this.suggestBox.acceptSuggestion();\n    }\n    if (!result) {\n      result = this.acceptSuggestionInternal();\n    }\n    if (this.usesSuggestionBuilder && result) {\n      // Trigger autocompletions for text prompts using suggestion builders\n      this.autoCompleteSoon();\n    }\n    return result;\n  }\n\n  clearAutocomplete(): void {\n    const beforeText = this.textWithCurrentSuggestion();\n\n    if (this.isSuggestBoxVisible() && this.suggestBox) {\n      this.suggestBox.hide();\n    }\n    this.clearAutocompleteTimeout();\n    this.queryRange = null;\n    this.refreshGhostText();\n\n    if (beforeText !== this.textWithCurrentSuggestion()) {\n      this.dispatchEventToListeners(Events.TextChanged);\n    }\n  }\n\n  private refreshGhostText(): void {\n    if (this.currentSuggestion && this.currentSuggestion.hideGhostText) {\n      this.ghostTextElement.remove();\n      return;\n    }\n    if (this.queryRange && this.currentSuggestion && this.isCaretAtEndOfPrompt() &&\n        this.currentSuggestion.text.startsWith(this.text().substring(this.queryRange.startColumn))) {\n      this.ghostTextElement.textContent =\n          this.currentSuggestion.text.substring(this.queryRange.endColumn - this.queryRange.startColumn);\n      this.element().appendChild(this.ghostTextElement);\n    } else {\n      this.ghostTextElement.remove();\n    }\n  }\n\n  private clearAutocompleteTimeout(): void {\n    if (this.completeTimeout) {\n      clearTimeout(this.completeTimeout);\n      delete this.completeTimeout;\n    }\n    this.completionRequestId++;\n  }\n\n  autoCompleteSoon(force?: boolean): void {\n    const immediately = this.isSuggestBoxVisible() || force;\n    if (!this.completeTimeout) {\n      this.completeTimeout =\n          window.setTimeout(this.complete.bind(this, force), immediately ? 0 : this.autocompletionTimeout);\n    }\n  }\n\n  async complete(force?: boolean): Promise<void> {\n    this.clearAutocompleteTimeout();\n    const selection = this.element().getComponentSelection();\n    if (!selection || selection.rangeCount === 0) {\n      return;\n    }\n    const selectionRange = selection.getRangeAt(0);\n\n    let shouldExit;\n\n    if (!force && !this.isCaretAtEndOfPrompt() && !this.isSuggestBoxVisible()) {\n      shouldExit = true;\n    } else if (!selection.isCollapsed) {\n      shouldExit = true;\n    }\n\n    if (shouldExit) {\n      this.clearAutocomplete();\n      return;\n    }\n\n    const wordQueryRange = DOMExtension.DOMExtension.rangeOfWord(\n        selectionRange.startContainer, selectionRange.startOffset, this.completionStopCharacters, this.element(),\n        'backward');\n\n    const expressionRange = wordQueryRange.cloneRange();\n    expressionRange.collapse(true);\n    expressionRange.setStartBefore(this.element());\n    const completionRequestId = ++this.completionRequestId;\n    const completions =\n        await this.loadCompletions.call(null, expressionRange.toString(), wordQueryRange.toString(), Boolean(force));\n    this.completionsReady(completionRequestId, (selection as Selection), wordQueryRange, Boolean(force), completions);\n  }\n\n  disableDefaultSuggestionForEmptyInput(): void {\n    this.disableDefaultSuggestionForEmptyInputInternal = true;\n  }\n\n  private boxForAnchorAtStart(selection: Selection, textRange: Range): AnchorBox {\n    const rangeCopy = selection.getRangeAt(0).cloneRange();\n    const anchorElement = document.createElement('span');\n    anchorElement.textContent = '\\u200B';\n    textRange.insertNode(anchorElement);\n    const box = anchorElement.boxInWindow(window);\n    anchorElement.remove();\n    selection.removeAllRanges();\n    selection.addRange(rangeCopy);\n    return box;\n  }\n\n  additionalCompletions(_query: string): Suggestion[] {\n    return [];\n  }\n\n  private completionsReady(\n      completionRequestId: number, selection: Selection, originalWordQueryRange: Range, force: boolean,\n      completions: Suggestion[]): void {\n    if (this.completionRequestId !== completionRequestId) {\n      return;\n    }\n\n    const query = originalWordQueryRange.toString();\n\n    // Filter out dupes.\n    const store = new Set<string>();\n    completions = completions.filter(item => !store.has(item.text) && Boolean(store.add(item.text)));\n\n    if (query || force) {\n      if (query) {\n        completions = completions.concat(this.additionalCompletions(query));\n      } else {\n        completions = this.additionalCompletions(query).concat(completions);\n      }\n    }\n\n    if (!completions.length) {\n      this.clearAutocomplete();\n      return;\n    }\n\n    const selectionRange = selection.getRangeAt(0);\n\n    const fullWordRange = document.createRange();\n    fullWordRange.setStart(originalWordQueryRange.startContainer, originalWordQueryRange.startOffset);\n    fullWordRange.setEnd(selectionRange.endContainer, selectionRange.endOffset);\n\n    if (query + selectionRange.toString() !== fullWordRange.toString()) {\n      return;\n    }\n\n    const beforeRange = document.createRange();\n    beforeRange.setStart(this.element(), 0);\n    beforeRange.setEnd(fullWordRange.startContainer, fullWordRange.startOffset);\n    this.queryRange = new TextUtils.TextRange.TextRange(\n        0, beforeRange.toString().length, 0, beforeRange.toString().length + fullWordRange.toString().length);\n\n    const shouldSelect = !this.disableDefaultSuggestionForEmptyInputInternal || Boolean(this.text());\n    if (this.suggestBox) {\n      this.suggestBox.updateSuggestions(\n          this.boxForAnchorAtStart(selection, fullWordRange), completions, shouldSelect, !this.isCaretAtEndOfPrompt(),\n          this.text());\n    }\n  }\n\n  applySuggestion(suggestion: Suggestion|null, isIntermediateSuggestion?: boolean): void {\n    this.currentSuggestion = suggestion;\n    this.refreshGhostText();\n    if (isIntermediateSuggestion) {\n      this.dispatchEventToListeners(Events.TextChanged);\n    }\n  }\n\n  acceptSuggestion(): void {\n    this.acceptSuggestionInternal();\n  }\n\n  private acceptSuggestionInternal(): boolean {\n    if (!this.queryRange) {\n      return false;\n    }\n\n    const suggestionLength = this.currentSuggestion ? this.currentSuggestion.text.length : 0;\n    const selectionRange = this.currentSuggestion ? this.currentSuggestion.selectionRange : null;\n    const endColumn = selectionRange ? selectionRange.endColumn : suggestionLength;\n    const startColumn = selectionRange ? selectionRange.startColumn : suggestionLength;\n    this.element().textContent = this.textWithCurrentSuggestion();\n    this.setDOMSelection(this.queryRange.startColumn + startColumn, this.queryRange.startColumn + endColumn);\n    this.updateLeftParenthesesIndices();\n\n    this.clearAutocomplete();\n    this.dispatchEventToListeners(Events.TextChanged);\n\n    return true;\n  }\n\n  ariaControlledBy(): Element {\n    return this.element();\n  }\n\n  setDOMSelection(startColumn: number, endColumn: number): void {\n    this.element().normalize();\n    const node = this.element().childNodes[0];\n    if (!node || node === this.ghostTextElement) {\n      return;\n    }\n    const range = document.createRange();\n    range.setStart(node, startColumn);\n    range.setEnd(node, endColumn);\n    const selection = this.element().getComponentSelection();\n    if (selection) {\n      selection.removeAllRanges();\n      selection.addRange(range);\n    }\n  }\n\n  isSuggestBoxVisible(): boolean {\n    return this.suggestBox !== undefined && this.suggestBox.visible();\n  }\n\n  isCaretInsidePrompt(): boolean {\n    const selection = this.element().getComponentSelection();\n    if (!selection || selection.rangeCount === 0 || !selection.isCollapsed) {\n      return false;\n    }\n    // @see crbug.com/602541\n    const selectionRange = selection.getRangeAt(0);\n    return selectionRange.startContainer.isSelfOrDescendant(this.element());\n  }\n\n  private isCaretAtEndOfPrompt(): boolean {\n    const selection = this.element().getComponentSelection();\n    if (!selection || selection.rangeCount === 0 || !selection.isCollapsed) {\n      return false;\n    }\n\n    const selectionRange = selection.getRangeAt(0);\n    let node: (Node|null)|Node = selectionRange.startContainer;\n    if (!node.isSelfOrDescendant(this.element())) {\n      return false;\n    }\n\n    if (this.ghostTextElement.isAncestor(node)) {\n      return true;\n    }\n\n    if (node.nodeType === Node.TEXT_NODE && selectionRange.startOffset < (node.nodeValue || '').length) {\n      return false;\n    }\n\n    let foundNextText = false;\n    while (node) {\n      if (node.nodeType === Node.TEXT_NODE && node.nodeValue && node.nodeValue.length) {\n        if (foundNextText && !this.ghostTextElement.isAncestor(node)) {\n          return false;\n        }\n        foundNextText = true;\n      }\n\n      node = node.traverseNextNode(this.elementInternal);\n    }\n\n    return true;\n  }\n\n  moveCaretToEndOfPrompt(): void {\n    const selection = this.element().getComponentSelection();\n    const selectionRange = document.createRange();\n\n    let container: Node = this.element();\n    while (container.lastChild) {\n      container = container.lastChild;\n    }\n    let offset = 0;\n    if (container.nodeType === Node.TEXT_NODE) {\n      const textNode = (container as Text);\n      offset = (textNode.textContent || '').length;\n    }\n    selectionRange.setStart(container, offset);\n    selectionRange.setEnd(container, offset);\n\n    if (selection) {\n      selection.removeAllRanges();\n      selection.addRange(selectionRange);\n    }\n  }\n\n  /** -1 if no caret can be found in text prompt\n     */\n  private getCaretPosition(): number {\n    if (!this.element().hasFocus()) {\n      return -1;\n    }\n\n    const selection = this.element().getComponentSelection();\n    if (!selection || selection.rangeCount === 0 || !selection.isCollapsed) {\n      return -1;\n    }\n    const selectionRange = selection.getRangeAt(0);\n    if (selectionRange.startOffset !== selectionRange.endOffset) {\n      return -1;\n    }\n    return selectionRange.startOffset;\n  }\n\n  tabKeyPressed(_event: Event): boolean {\n    return this.acceptAutoComplete();\n  }\n\n  proxyElementForTests(): Element|null {\n    return this.proxyElement || null;\n  }\n\n  /**\n   * Try matching the most recent open parenthesis with the given right\n   * parenthesis, and closes the matched left parenthesis if found.\n   * Return the result of the matching.\n   */\n  private tryMatchingLeftParenthesis(rightParenthesisIndex: number): boolean {\n    const leftParenthesesIndices = this.leftParenthesesIndices;\n    if (leftParenthesesIndices.length === 0 || rightParenthesisIndex < 0) {\n      return false;\n    }\n\n    for (let i = leftParenthesesIndices.length - 1; i >= 0; --i) {\n      if (leftParenthesesIndices[i] < rightParenthesisIndex) {\n        leftParenthesesIndices.splice(i, 1);\n        return true;\n      }\n    }\n\n    return false;\n  }\n\n  private updateLeftParenthesesIndices(): void {\n    const text = this.text();\n    const leftParenthesesIndices: number[] = this.leftParenthesesIndices = [];\n    for (let i = 0; i < text.length; ++i) {\n      if (text[i] === '(') {\n        leftParenthesesIndices.push(i);\n      }\n    }\n  }\n}\n\nconst DefaultAutocompletionTimeout = 250;\n\n// TODO(crbug.com/1167717): Make this a const enum again\n// eslint-disable-next-line rulesdir/const_enum\nexport enum Events {\n  TextChanged = 'TextChanged',\n}\n\nexport type EventTypes = {\n  [Events.TextChanged]: void,\n};\n"],
  "mappings": "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",
  "names": []
}
