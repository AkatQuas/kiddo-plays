{
  "version": 3,
  "sources": ["../../../../../../../../front_end/ui/legacy/components/inline_editor/BezierUI.ts"],
  "sourcesContent": ["// Copyright (c) 2015 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport * as UI from '../../legacy.js';\n\nexport class BezierUI {\n  width: number;\n  height: number;\n  marginTop: number;\n  radius: number;\n  linearLine: boolean;\n\n  constructor(width: number, height: number, marginTop: number, controlPointRadius: number, linearLine: boolean) {\n    this.width = width;\n    this.height = height;\n    this.marginTop = marginTop;\n    this.radius = controlPointRadius;\n    this.linearLine = linearLine;\n  }\n\n  static drawVelocityChart(bezier: UI.Geometry.CubicBezier, path: Element, width: number): void {\n    const height = Height;\n    let pathBuilder: (string|number)[]|(string | number)[] = ['M', 0, height];\n    /** @const */ const sampleSize = 1 / 40;\n\n    let prev = bezier.evaluateAt(0);\n    for (let t = sampleSize; t < 1 + sampleSize; t += sampleSize) {\n      const current = bezier.evaluateAt(t);\n      let slope: number = (current.y - prev.y) / (current.x - prev.x);\n      const weightedX = prev.x * (1 - t) + current.x * t;\n      slope = Math.tanh(slope / 1.5);  // Normalise slope\n      pathBuilder = pathBuilder.concat(['L', (weightedX * width).toFixed(2), (height - slope * height).toFixed(2)]);\n      prev = current;\n    }\n    pathBuilder = pathBuilder.concat(['L', width.toFixed(2), height, 'Z']);\n    path.setAttribute('d', pathBuilder.join(' '));\n  }\n\n  curveWidth(): number {\n    return this.width - this.radius * 2;\n  }\n\n  curveHeight(): number {\n    return this.height - this.radius * 2 - this.marginTop * 2;\n  }\n\n  private drawLine(parentElement: Element, className: string, x1: number, y1: number, x2: number, y2: number): void {\n    const line = UI.UIUtils.createSVGChild(parentElement, 'line', className);\n    line.setAttribute('x1', String(x1 + this.radius));\n    line.setAttribute('y1', String(y1 + this.radius + this.marginTop));\n    line.setAttribute('x2', String(x2 + this.radius));\n    line.setAttribute('y2', String(y2 + this.radius + this.marginTop));\n  }\n\n  private drawControlPoints(parentElement: Element, startX: number, startY: number, controlX: number, controlY: number):\n      void {\n    this.drawLine(parentElement, 'bezier-control-line', startX, startY, controlX, controlY);\n    const circle = UI.UIUtils.createSVGChild(parentElement, 'circle', 'bezier-control-circle');\n    circle.setAttribute('cx', String(controlX + this.radius));\n    circle.setAttribute('cy', String(controlY + this.radius + this.marginTop));\n    circle.setAttribute('r', String(this.radius));\n  }\n\n  drawCurve(bezier: UI.Geometry.CubicBezier|null, svg: Element): void {\n    if (!bezier) {\n      return;\n    }\n    const width = this.curveWidth();\n    const height = this.curveHeight();\n    svg.setAttribute('width', String(this.width));\n    svg.setAttribute('height', String(this.height));\n    svg.removeChildren();\n    const group = UI.UIUtils.createSVGChild(svg, 'g');\n\n    if (this.linearLine) {\n      this.drawLine(group, 'linear-line', 0, height, width, 0);\n    }\n\n    const curve = UI.UIUtils.createSVGChild(group, 'path', 'bezier-path');\n    const curvePoints = [\n      new UI.Geometry.Point(\n          bezier.controlPoints[0].x * width + this.radius,\n          (1 - bezier.controlPoints[0].y) * height + this.radius + this.marginTop),\n      new UI.Geometry.Point(\n          bezier.controlPoints[1].x * width + this.radius,\n          (1 - bezier.controlPoints[1].y) * height + this.radius + this.marginTop),\n      new UI.Geometry.Point(width + this.radius, this.marginTop + this.radius),\n    ];\n    curve.setAttribute(\n        'd', 'M' + this.radius + ',' + (height + this.radius + this.marginTop) + ' C' + curvePoints.join(' '));\n\n    this.drawControlPoints(\n        group, 0, height, bezier.controlPoints[0].x * width, (1 - bezier.controlPoints[0].y) * height);\n    this.drawControlPoints(\n        group, width, 0, bezier.controlPoints[1].x * width, (1 - bezier.controlPoints[1].y) * height);\n  }\n}\n\nexport const Height = 26;\n"],
  "mappings": "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",
  "names": []
}
