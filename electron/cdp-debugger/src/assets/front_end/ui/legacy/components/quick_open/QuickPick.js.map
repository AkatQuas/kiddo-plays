{
  "version": 3,
  "sources": ["../../../../../../../../front_end/ui/legacy/components/quick_open/QuickPick.ts"],
  "sourcesContent": ["// Copyright 2020 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport * as Diff from '../../../../third_party/diff/diff.js';\nimport * as UI from '../../legacy.js';\nimport {Events as FilteredListWidgetEvents, FilteredListWidget, Provider} from './FilteredListWidget.js';\nexport interface QuickPickItem {\n  label: string;\n  description?: string;\n  detail?: string;\n}\nexport interface QuickPickOptions {\n  placeHolder: string;\n  matchOnDescription?: boolean;\n  matchOnDetail?: boolean;\n}\n\nexport class QuickPick {\n  private constructor() {\n    throw new ReferenceError('Instance type not implemented.');\n  }\n\n  static show(items: QuickPickItem[], options: QuickPickOptions): Promise<QuickPickItem|void> {\n    let canceledPromise = new Promise<void>(_r => {});  // Intentionally creates an unresolved promise\n    const fulfilledPromise = new Promise<QuickPickItem>(resolve => {\n      const provider =\n          new QuickPickProvider(items, resolve, options.matchOnDescription ? 0.5 : 0, options.matchOnDetail ? 0.25 : 0);\n      const widget = new FilteredListWidget(provider);\n      widget.setHintElement(options.placeHolder);\n      widget.setPromptTitle(options.placeHolder);\n      widget.showAsDialog(options.placeHolder);\n      canceledPromise = widget.once(FilteredListWidgetEvents.Hidden);\n      widget.setQuery('');\n    });\n\n    return Promise.race([fulfilledPromise, canceledPromise]).then(values => {\n      // If it was fulfilled, then `result` will have a value.\n      // If it was canceled, then `result` will be undefined.\n      // Either way, it has the value that we want.\n      return values;\n    });\n  }\n}\n\nclass QuickPickProvider extends Provider {\n  private readonly resolve: Function;\n  private readonly items: QuickPickItem[];\n  private matchOnDescription: number;\n  private matchOnDetail: number;\n  constructor(\n      items: QuickPickItem[], resolve: Function, matchOnDescription: number|undefined = 0.5,\n      matchOnDetail: number|undefined = 0.25) {\n    super();\n    this.resolve = resolve;\n    this.items = items;\n    this.matchOnDescription = matchOnDescription;\n    this.matchOnDetail = matchOnDetail;\n  }\n\n  itemCount(): number {\n    return this.items.length;\n  }\n\n  itemKeyAt(itemIndex: number): string {\n    const item = this.items[itemIndex];\n    let key = item.label;\n    if (this.matchOnDescription) {\n      key += ' ' + item.description;\n    }\n    if (this.matchOnDetail) {\n      key += ' ' + item.detail;\n    }\n    return key;\n  }\n\n  itemScoreAt(itemIndex: number, query: string): number {\n    const item = this.items[itemIndex];\n    const test = query.toLowerCase();\n    let score = Diff.Diff.DiffWrapper.characterScore(test, item.label.toLowerCase());\n\n    if (this.matchOnDescription && item.description) {\n      const descriptionScore = Diff.Diff.DiffWrapper.characterScore(test, item.description.toLowerCase());\n      score += descriptionScore * this.matchOnDescription;\n    }\n\n    if (this.matchOnDetail && item.detail) {\n      const detailScore = Diff.Diff.DiffWrapper.characterScore(test, item.detail.toLowerCase());\n      score += detailScore * this.matchOnDetail;\n    }\n\n    return score;\n  }\n\n  renderItem(itemIndex: number, query: string, titleElement: Element, subtitleElement: Element): void {\n    const item = this.items[itemIndex];\n    titleElement.removeChildren();\n    const labelElement = titleElement.createChild('span');\n    UI.UIUtils.createTextChild(labelElement, item.label);\n    FilteredListWidget.highlightRanges(titleElement, query, true);\n    if (item.description) {\n      const descriptionElement = titleElement.createChild('span', 'quickpick-description');\n      UI.UIUtils.createTextChild(descriptionElement, item.description);\n      if (this.matchOnDescription) {\n        FilteredListWidget.highlightRanges(descriptionElement, query, true);\n      }\n    }\n    if (item.detail) {\n      UI.UIUtils.createTextChild(subtitleElement, item.detail);\n      if (this.matchOnDetail) {\n        FilteredListWidget.highlightRanges(subtitleElement, query, true);\n      }\n    }\n  }\n\n  renderAsTwoRows(): boolean {\n    return this.items.some(i => Boolean(i.detail));\n  }\n\n  selectItem(itemIndex: number|null, _promptValue: string): void {\n    if (typeof itemIndex === 'number') {\n      this.resolve(this.items[itemIndex]);\n      return;\n    }\n\n    this.resolve(undefined);\n  }\n}\n"],
  "mappings": "AAIA;AACA;AACA;AAYO,uBAAgB;AAAA,EACb,cAAc;AACpB,UAAM,IAAI,eAAe;AAAA;AAAA,SAGpB,KAAK,OAAwB,SAAwD;AAC1F,QAAI,kBAAkB,IAAI,QAAc,QAAM;AAAA;AAC9C,UAAM,mBAAmB,IAAI,QAAuB,aAAW;AAC7D,YAAM,WACF,IAAI,kBAAkB,OAAO,SAAS,QAAQ,qBAAqB,MAAM,GAAG,QAAQ,gBAAgB,OAAO;AAC/G,YAAM,SAAS,IAAI,mBAAmB;AACtC,aAAO,eAAe,QAAQ;AAC9B,aAAO,eAAe,QAAQ;AAC9B,aAAO,aAAa,QAAQ;AAC5B,wBAAkB,OAAO,KAAK,yBAAyB;AACvD,aAAO,SAAS;AAAA;AAGlB,WAAO,QAAQ,KAAK,CAAC,kBAAkB,kBAAkB,KAAK,YAAU;AAItE,aAAO;AAAA;AAAA;AAAA;AAKb,gCAAgC,SAAS;AAAA,EACtB;AAAA,EACA;AAAA,EACT;AAAA,EACA;AAAA,EACR,YACI,OAAwB,SAAmB,qBAAuC,KAClF,gBAAkC,MAAM;AAC1C;AACA,SAAK,UAAU;AACf,SAAK,QAAQ;AACb,SAAK,qBAAqB;AAC1B,SAAK,gBAAgB;AAAA;AAAA,EAGvB,YAAoB;AAClB,WAAO,KAAK,MAAM;AAAA;AAAA,EAGpB,UAAU,WAA2B;AACnC,UAAM,OAAO,KAAK,MAAM;AACxB,QAAI,MAAM,KAAK;AACf,QAAI,KAAK,oBAAoB;AAC3B,aAAO,MAAM,KAAK;AAAA;AAEpB,QAAI,KAAK,eAAe;AACtB,aAAO,MAAM,KAAK;AAAA;AAEpB,WAAO;AAAA;AAAA,EAGT,YAAY,WAAmB,OAAuB;AACpD,UAAM,OAAO,KAAK,MAAM;AACxB,UAAM,OAAO,MAAM;AACnB,QAAI,QAAQ,KAAK,KAAK,YAAY,eAAe,MAAM,KAAK,MAAM;AAElE,QAAI,KAAK,sBAAsB,KAAK,aAAa;AAC/C,YAAM,mBAAmB,KAAK,KAAK,YAAY,eAAe,MAAM,KAAK,YAAY;AACrF,eAAS,mBAAmB,KAAK;AAAA;AAGnC,QAAI,KAAK,iBAAiB,KAAK,QAAQ;AACrC,YAAM,cAAc,KAAK,KAAK,YAAY,eAAe,MAAM,KAAK,OAAO;AAC3E,eAAS,cAAc,KAAK;AAAA;AAG9B,WAAO;AAAA;AAAA,EAGT,WAAW,WAAmB,OAAe,cAAuB,iBAAgC;AAClG,UAAM,OAAO,KAAK,MAAM;AACxB,iBAAa;AACb,UAAM,eAAe,aAAa,YAAY;AAC9C,OAAG,QAAQ,gBAAgB,cAAc,KAAK;AAC9C,uBAAmB,gBAAgB,cAAc,OAAO;AACxD,QAAI,KAAK,aAAa;AACpB,YAAM,qBAAqB,aAAa,YAAY,QAAQ;AAC5D,SAAG,QAAQ,gBAAgB,oBAAoB,KAAK;AACpD,UAAI,KAAK,oBAAoB;AAC3B,2BAAmB,gBAAgB,oBAAoB,OAAO;AAAA;AAAA;AAGlE,QAAI,KAAK,QAAQ;AACf,SAAG,QAAQ,gBAAgB,iBAAiB,KAAK;AACjD,UAAI,KAAK,eAAe;AACtB,2BAAmB,gBAAgB,iBAAiB,OAAO;AAAA;AAAA;AAAA;AAAA,EAKjE,kBAA2B;AACzB,WAAO,KAAK,MAAM,KAAK,OAAK,QAAQ,EAAE;AAAA;AAAA,EAGxC,WAAW,WAAwB,cAA4B;AAC7D,QAAI,OAAO,cAAc,UAAU;AACjC,WAAK,QAAQ,KAAK,MAAM;AACxB;AAAA;AAGF,SAAK,QAAQ;AAAA;AAAA;",
  "names": []
}
