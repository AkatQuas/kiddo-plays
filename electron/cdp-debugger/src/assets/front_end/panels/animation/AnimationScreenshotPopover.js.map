{
  "version": 3,
  "sources": ["../../../../../../front_end/panels/animation/AnimationScreenshotPopover.ts"],
  "sourcesContent": ["// Copyright (c) 2015 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport * as UI from '../../ui/legacy/legacy.js';\n\nimport animationScreenshotPopoverStyles from './animationScreenshotPopover.css.js';\n\nexport class AnimationScreenshotPopover extends UI.Widget.VBox {\n  #frames: HTMLImageElement[];\n  #rafId: number;\n  #currentFrame: number;\n  #progressBar: HTMLElement;\n  #showFrame?: boolean;\n  #endDelay?: number;\n  constructor(images: HTMLImageElement[]) {\n    super(true);\n    console.assert(images.length > 0);\n\n    this.contentElement.classList.add('animation-screenshot-popover');\n    this.#frames = images;\n    for (const image of images) {\n      this.contentElement.appendChild(image);\n      image.style.display = 'none';\n    }\n    this.#rafId = 0;\n    this.#currentFrame = 0;\n    this.#frames[0].style.display = 'block';\n    this.#progressBar = this.contentElement.createChild('div', 'animation-progress');\n  }\n\n  wasShown(): void {\n    this.#rafId = this.contentElement.window().requestAnimationFrame(this.changeFrame.bind(this));\n    this.registerCSSFiles([animationScreenshotPopoverStyles]);\n  }\n\n  willHide(): void {\n    this.contentElement.window().cancelAnimationFrame(this.#rafId);\n    this.#endDelay = undefined;\n  }\n\n  private changeFrame(): void {\n    this.#rafId = this.contentElement.window().requestAnimationFrame(this.changeFrame.bind(this));\n\n    if (this.#endDelay) {\n      this.#endDelay--;\n      return;\n    }\n    this.#showFrame = !this.#showFrame;\n    if (!this.#showFrame) {\n      return;\n    }\n\n    const numFrames = this.#frames.length;\n    this.#frames[this.#currentFrame % numFrames].style.display = 'none';\n    this.#currentFrame++;\n    this.#frames[(this.#currentFrame) % numFrames].style.display = 'block';\n    if (this.#currentFrame % numFrames === numFrames - 1) {\n      this.#endDelay = 50;\n    }\n    this.#progressBar.style.width = (this.#currentFrame % numFrames + 1) / numFrames * 100 + '%';\n  }\n}\n"],
  "mappings": "AAIA;AAEA;AAEO,gDAAyC,GAAG,OAAO,KAAK;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAO7D,YAAY,QAA4B;AACtC,UAAM;AACN,YAAQ,OAAO,OAAO,SAAS;AAE/B,SAAK,eAAe,UAAU,IAAI;AAClC,mBAAe;AACf,eAAW,SAAS,QAAQ;AAC1B,WAAK,eAAe,YAAY;AAChC,YAAM,MAAM,UAAU;AAAA;AAExB,kBAAc;AACd,yBAAqB;AACrB,iBAAa,GAAG,MAAM,UAAU;AAChC,wBAAoB,KAAK,eAAe,YAAY,OAAO;AAAA;AAAA,EAG7D,WAAiB;AACf,kBAAc,KAAK,eAAe,SAAS,sBAAsB,KAAK,YAAY,KAAK;AACvF,SAAK,iBAAiB,CAAC;AAAA;AAAA,EAGzB,WAAiB;AACf,SAAK,eAAe,SAAS,qBAAqB;AAClD,qBAAiB;AAAA;AAAA,EAGX,cAAoB;AAC1B,kBAAc,KAAK,eAAe,SAAS,sBAAsB,KAAK,YAAY,KAAK;AAEvF,QAAI,gBAAgB;AAClB;AACA;AAAA;AAEF,sBAAkB,CAAC;AACnB,QAAI,CAAC,iBAAiB;AACpB;AAAA;AAGF,UAAM,YAAY,aAAa;AAC/B,iBAAa,qBAAqB,WAAW,MAAM,UAAU;AAC7D;AACA,iBAAc,qBAAsB,WAAW,MAAM,UAAU;AAC/D,QAAI,qBAAqB,cAAc,YAAY,GAAG;AACpD,uBAAiB;AAAA;AAEnB,sBAAkB,MAAM,QAAS,sBAAqB,YAAY,KAAK,YAAY,MAAM;AAAA;AAAA;",
  "names": []
}
