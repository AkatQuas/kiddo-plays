{
  "version": 3,
  "sources": ["../../../../../../front_end/panels/emulation/InspectedPagePlaceholder.ts"],
  "sourcesContent": ["// Copyright 2014 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport * as Common from '../../core/common/common.js';\nimport * as UI from '../../ui/legacy/legacy.js';\n\nimport inspectedPagePlaceholderStyles from './inspectedPagePlaceholder.css.legacy.js';\n\nlet inspectedPagePlaceholderInstance: InspectedPagePlaceholder;\n\nexport class InspectedPagePlaceholder extends Common.ObjectWrapper.eventMixin<EventTypes, typeof UI.Widget.Widget>(\n    UI.Widget.Widget) {\n  private updateId?: number;\n  constructor() {\n    super(true);\n    this.registerRequiredCSS(inspectedPagePlaceholderStyles);\n    UI.ZoomManager.ZoomManager.instance().addEventListener(UI.ZoomManager.Events.ZoomChanged, this.onResize, this);\n    this.restoreMinimumSize();\n  }\n\n  static instance(opts: {\n    forceNew: null,\n  } = {forceNew: null}): InspectedPagePlaceholder {\n    const {forceNew} = opts;\n    if (!inspectedPagePlaceholderInstance || forceNew) {\n      inspectedPagePlaceholderInstance = new InspectedPagePlaceholder();\n    }\n\n    return inspectedPagePlaceholderInstance;\n  }\n\n  onResize(): void {\n    if (this.updateId) {\n      this.element.window().cancelAnimationFrame(this.updateId);\n    }\n    this.updateId = this.element.window().requestAnimationFrame(this.update.bind(this, false));\n  }\n\n  restoreMinimumSize(): void {\n    this.setMinimumSize(150, 150);\n  }\n\n  clearMinimumSize(): void {\n    this.setMinimumSize(1, 1);\n  }\n\n  private dipPageRect(): {\n    x: number,\n    y: number,\n    width: number,\n    height: number,\n  } {\n    const zoomFactor = UI.ZoomManager.ZoomManager.instance().zoomFactor();\n    const rect = this.element.getBoundingClientRect();\n    const bodyRect = this.element.ownerDocument.body.getBoundingClientRect();\n\n    const left = Math.max(rect.left * zoomFactor, bodyRect.left * zoomFactor);\n    const top = Math.max(rect.top * zoomFactor, bodyRect.top * zoomFactor);\n    const bottom = Math.min(rect.bottom * zoomFactor, bodyRect.bottom * zoomFactor);\n    const right = Math.min(rect.right * zoomFactor, bodyRect.right * zoomFactor);\n\n    return {x: left, y: top, width: right - left, height: bottom - top};\n  }\n\n  update(force?: boolean): void {\n    delete this.updateId;\n    const rect = this.dipPageRect();\n    const bounds = {\n      x: Math.round(rect.x),\n      y: Math.round(rect.y),\n      height: Math.max(1, Math.round(rect.height)),\n      width: Math.max(1, Math.round(rect.width)),\n    };\n    if (force) {\n      // Short term fix for Lighthouse interop.\n      --bounds.height;\n      this.dispatchEventToListeners(Events.Update, bounds);\n      ++bounds.height;\n    }\n    this.dispatchEventToListeners(Events.Update, bounds);\n  }\n}\n\nexport const enum Events {\n  Update = 'Update',\n}\n\nexport interface Bounds {\n  x: number;\n  y: number;\n  height: number;\n  width: number;\n}\n\nexport type EventTypes = {\n  [Events.Update]: Bounds,\n};\n"],
  "mappings": "AAIA;AACA;AAEA;AAEA,IAAI;AAEG,8CAAuC,OAAO,cAAc,WAC/D,GAAG,OAAO,QAAQ;AAAA,EACZ;AAAA,EACR,cAAc;AACZ,UAAM;AACN,SAAK,oBAAoB;AACzB,OAAG,YAAY,YAAY,WAAW,iBAAiB,GAAG,YAAY,OAAO,aAAa,KAAK,UAAU;AACzG,SAAK;AAAA;AAAA,SAGA,SAAS,OAEZ,EAAC,UAAU,QAAiC;AAC9C,UAAM,EAAC,aAAY;AACnB,QAAI,CAAC,oCAAoC,UAAU;AACjD,yCAAmC,IAAI;AAAA;AAGzC,WAAO;AAAA;AAAA,EAGT,WAAiB;AACf,QAAI,KAAK,UAAU;AACjB,WAAK,QAAQ,SAAS,qBAAqB,KAAK;AAAA;AAElD,SAAK,WAAW,KAAK,QAAQ,SAAS,sBAAsB,KAAK,OAAO,KAAK,MAAM;AAAA;AAAA,EAGrF,qBAA2B;AACzB,SAAK,eAAe,KAAK;AAAA;AAAA,EAG3B,mBAAyB;AACvB,SAAK,eAAe,GAAG;AAAA;AAAA,EAGjB,cAKN;AACA,UAAM,aAAa,GAAG,YAAY,YAAY,WAAW;AACzD,UAAM,OAAO,KAAK,QAAQ;AAC1B,UAAM,WAAW,KAAK,QAAQ,cAAc,KAAK;AAEjD,UAAM,OAAO,KAAK,IAAI,KAAK,OAAO,YAAY,SAAS,OAAO;AAC9D,UAAM,MAAM,KAAK,IAAI,KAAK,MAAM,YAAY,SAAS,MAAM;AAC3D,UAAM,SAAS,KAAK,IAAI,KAAK,SAAS,YAAY,SAAS,SAAS;AACpE,UAAM,QAAQ,KAAK,IAAI,KAAK,QAAQ,YAAY,SAAS,QAAQ;AAEjE,WAAO,EAAC,GAAG,MAAM,GAAG,KAAK,OAAO,QAAQ,MAAM,QAAQ,SAAS;AAAA;AAAA,EAGjE,OAAO,OAAuB;AAC5B,WAAO,KAAK;AACZ,UAAM,OAAO,KAAK;AAClB,UAAM,SAAS;AAAA,MACb,GAAG,KAAK,MAAM,KAAK;AAAA,MACnB,GAAG,KAAK,MAAM,KAAK;AAAA,MACnB,QAAQ,KAAK,IAAI,GAAG,KAAK,MAAM,KAAK;AAAA,MACpC,OAAO,KAAK,IAAI,GAAG,KAAK,MAAM,KAAK;AAAA;AAErC,QAAI,OAAO;AAET,QAAE,OAAO;AACT,WAAK,yBAAyB,OAAO,QAAQ;AAC7C,QAAE,OAAO;AAAA;AAEX,SAAK,yBAAyB,OAAO,QAAQ;AAAA;AAAA;AAI1C,WAAW,SAAX,kBAAW,YAAX;AACL,sBAAS;AADO;AAAA;",
  "names": []
}
