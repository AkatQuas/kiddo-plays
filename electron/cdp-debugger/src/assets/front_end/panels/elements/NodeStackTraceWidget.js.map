{
  "version": 3,
  "sources": ["../../../../../../front_end/panels/elements/NodeStackTraceWidget.ts"],
  "sourcesContent": ["// Copyright 2019 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport * as i18n from '../../core/i18n/i18n.js';\nimport * as SDK from '../../core/sdk/sdk.js';\nimport * as Components from '../../ui/legacy/components/utils/utils.js';\nimport * as UI from '../../ui/legacy/legacy.js';\n\nimport nodeStackTraceWidgetStyles from './nodeStackTraceWidget.css.js';\n\nconst UIStrings = {\n  /**\n  *@description Message displayed when no JavaScript stack trace is available for the DOM node in the Stack Trace widget of the Elements panel\n  */\n  noStackTraceAvailable: 'No stack trace available',\n};\nconst str_ = i18n.i18n.registerUIStrings('panels/elements/NodeStackTraceWidget.ts', UIStrings);\nconst i18nString = i18n.i18n.getLocalizedString.bind(undefined, str_);\nlet nodeStackTraceWidgetInstance: NodeStackTraceWidget;\n\nexport class NodeStackTraceWidget extends UI.ThrottledWidget.ThrottledWidget {\n  private readonly noStackTraceElement: HTMLElement;\n  private readonly creationStackTraceElement: HTMLElement;\n  private readonly linkifier: Components.Linkifier.Linkifier;\n\n  constructor() {\n    super(true /* isWebComponent */);\n\n    this.noStackTraceElement = this.contentElement.createChild('div', 'gray-info-message');\n    this.noStackTraceElement.textContent = i18nString(UIStrings.noStackTraceAvailable);\n    this.creationStackTraceElement = this.contentElement.createChild('div', 'stack-trace');\n\n    this.linkifier = new Components.Linkifier.Linkifier(MaxLengthForLinks);\n  }\n\n  static instance(opts: {\n    forceNew: boolean|null,\n  }|undefined = {forceNew: null}): NodeStackTraceWidget {\n    const {forceNew} = opts;\n    if (!nodeStackTraceWidgetInstance || forceNew) {\n      nodeStackTraceWidgetInstance = new NodeStackTraceWidget();\n    }\n\n    return nodeStackTraceWidgetInstance;\n  }\n\n  wasShown(): void {\n    super.wasShown();\n    UI.Context.Context.instance().addFlavorChangeListener(SDK.DOMModel.DOMNode, this.update, this);\n    this.registerCSSFiles([nodeStackTraceWidgetStyles]);\n    this.update();\n  }\n\n  willHide(): void {\n    UI.Context.Context.instance().removeFlavorChangeListener(SDK.DOMModel.DOMNode, this.update, this);\n  }\n\n  async doUpdate(): Promise<void> {\n    const node = UI.Context.Context.instance().flavor(SDK.DOMModel.DOMNode);\n\n    if (!node) {\n      this.noStackTraceElement.classList.remove('hidden');\n      this.creationStackTraceElement.classList.add('hidden');\n      return;\n    }\n\n    const creationStackTrace = await node.creationStackTrace();\n    if (creationStackTrace) {\n      this.noStackTraceElement.classList.add('hidden');\n      this.creationStackTraceElement.classList.remove('hidden');\n\n      const stackTracePreview = Components.JSPresentationUtils.buildStackTracePreviewContents(\n          node.domModel().target(), this.linkifier, {stackTrace: creationStackTrace, tabStops: undefined});\n      this.creationStackTraceElement.removeChildren();\n      this.creationStackTraceElement.appendChild(stackTracePreview.element);\n    } else {\n      this.noStackTraceElement.classList.remove('hidden');\n      this.creationStackTraceElement.classList.add('hidden');\n    }\n  }\n}\n\nexport const MaxLengthForLinks = 40;\n"],
  "mappings": "AAIA;AACA;AACA;AACA;AAEA;AAEA,MAAM,YAAY;AAAA,EAIhB,uBAAuB;AAAA;AAEzB,MAAM,OAAO,KAAK,KAAK,kBAAkB,2CAA2C;AACpF,MAAM,aAAa,KAAK,KAAK,mBAAmB,KAAK,QAAW;AAChE,IAAI;AAEG,0CAAmC,GAAG,gBAAgB,gBAAgB;AAAA,EAC1D;AAAA,EACA;AAAA,EACA;AAAA,EAEjB,cAAc;AACZ,UAAM;AAEN,SAAK,sBAAsB,KAAK,eAAe,YAAY,OAAO;AAClE,SAAK,oBAAoB,cAAc,WAAW,UAAU;AAC5D,SAAK,4BAA4B,KAAK,eAAe,YAAY,OAAO;AAExE,SAAK,YAAY,IAAI,WAAW,UAAU,UAAU;AAAA;AAAA,SAG/C,SAAS,OAEF,EAAC,UAAU,QAA6B;AACpD,UAAM,EAAC,aAAY;AACnB,QAAI,CAAC,gCAAgC,UAAU;AAC7C,qCAA+B,IAAI;AAAA;AAGrC,WAAO;AAAA;AAAA,EAGT,WAAiB;AACf,UAAM;AACN,OAAG,QAAQ,QAAQ,WAAW,wBAAwB,IAAI,SAAS,SAAS,KAAK,QAAQ;AACzF,SAAK,iBAAiB,CAAC;AACvB,SAAK;AAAA;AAAA,EAGP,WAAiB;AACf,OAAG,QAAQ,QAAQ,WAAW,2BAA2B,IAAI,SAAS,SAAS,KAAK,QAAQ;AAAA;AAAA,QAGxF,WAA0B;AAC9B,UAAM,OAAO,GAAG,QAAQ,QAAQ,WAAW,OAAO,IAAI,SAAS;AAE/D,QAAI,CAAC,MAAM;AACT,WAAK,oBAAoB,UAAU,OAAO;AAC1C,WAAK,0BAA0B,UAAU,IAAI;AAC7C;AAAA;AAGF,UAAM,qBAAqB,MAAM,KAAK;AACtC,QAAI,oBAAoB;AACtB,WAAK,oBAAoB,UAAU,IAAI;AACvC,WAAK,0BAA0B,UAAU,OAAO;AAEhD,YAAM,oBAAoB,WAAW,oBAAoB,+BACrD,KAAK,WAAW,UAAU,KAAK,WAAW,EAAC,YAAY,oBAAoB,UAAU;AACzF,WAAK,0BAA0B;AAC/B,WAAK,0BAA0B,YAAY,kBAAkB;AAAA,WACxD;AACL,WAAK,oBAAoB,UAAU,OAAO;AAC1C,WAAK,0BAA0B,UAAU,IAAI;AAAA;AAAA;AAAA;AAK5C,aAAM,oBAAoB;",
  "names": []
}
