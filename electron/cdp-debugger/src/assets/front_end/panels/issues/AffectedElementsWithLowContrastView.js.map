{
  "version": 3,
  "sources": ["../../../../../../front_end/panels/issues/AffectedElementsWithLowContrastView.ts"],
  "sourcesContent": ["// Copyright 2021 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport * as i18n from '../../core/i18n/i18n.js';\nimport * as Platform from '../../core/platform/platform.js';\nimport type * as IssuesManager from '../../models/issues_manager/issues_manager.js';\n\nimport {AffectedElementsView} from './AffectedElementsView.js';\n\nexport class AffectedElementsWithLowContrastView extends AffectedElementsView {\n  #runningUpdatePromise: Promise<void> = Promise.resolve();\n\n  update(): void {\n    // Ensure that doUpdate is invoked atomically by serializing the update calls\n    // because it's not re-entrace safe.\n    this.#runningUpdatePromise = this.#runningUpdatePromise.then(this.#doUpdate.bind(this));\n  }\n\n  async #doUpdate(): Promise<void> {\n    this.clear();\n    await this.#appendLowContrastElements(this.issue.getLowContrastIssues());\n  }\n\n  async #appendLowContrastElement(issue: IssuesManager.LowTextContrastIssue.LowTextContrastIssue): Promise<void> {\n    const row = document.createElement('tr');\n    row.classList.add('affected-resource-low-contrast');\n\n    const details = issue.details();\n    const target = issue.model()?.target() || null;\n    row.appendChild(await this.createElementCell(\n        {nodeName: details.violatingNodeSelector, backendNodeId: details.violatingNodeId, target},\n        issue.getCategory()));\n    this.appendIssueDetailCell(row, String(Platform.NumberUtilities.floor(details.contrastRatio, 2)));\n    this.appendIssueDetailCell(row, String(details.thresholdAA));\n    this.appendIssueDetailCell(row, String(details.thresholdAAA));\n    this.appendIssueDetailCell(row, details.fontSize);\n    this.appendIssueDetailCell(row, details.fontWeight);\n\n    this.affectedResources.appendChild(row);\n  }\n\n  async #appendLowContrastElements(issues: Iterable<IssuesManager.LowTextContrastIssue.LowTextContrastIssue>):\n      Promise<void> {\n    const header = document.createElement('tr');\n    this.appendColumnTitle(header, i18nString(UIStrings.element));\n    this.appendColumnTitle(header, i18nString(UIStrings.contrastRatio));\n    this.appendColumnTitle(header, i18nString(UIStrings.minimumAA));\n    this.appendColumnTitle(header, i18nString(UIStrings.minimumAAA));\n    this.appendColumnTitle(header, i18nString(UIStrings.textSize));\n    this.appendColumnTitle(header, i18nString(UIStrings.textWeight));\n\n    this.affectedResources.appendChild(header);\n    let count = 0;\n    for (const lowContrastIssue of issues) {\n      count++;\n      await this.#appendLowContrastElement(lowContrastIssue);\n    }\n    this.updateAffectedResourceCount(count);\n  }\n}\n\nconst UIStrings = {\n  /**\n  *@description Column title for the element column in the low contrast issue view\n  */\n  element: 'Element',\n  /**\n  *@description Column title for the contrast ratio column in the low contrast issue view\n  */\n  contrastRatio: 'Contrast ratio',\n  /**\n  *@description Column title for the minimum AA contrast ratio column in the low contrast issue view\n  */\n  minimumAA: 'Minimum AA ratio',\n  /**\n  *@description Column title for the minimum AAA contrast ratio column in the low contrast issue view\n  */\n  minimumAAA: 'Minimum AAA ratio',\n  /**\n  *@description Column title for the text size column in the low contrast issue view\n  */\n  textSize: 'Text size',\n  /**\n  *@description Column title for the text weight column in the low contrast issue view\n  */\n  textWeight: 'Text weight',\n};\nconst str_ = i18n.i18n.registerUIStrings('panels/issues/AffectedElementsWithLowContrastView.ts', UIStrings);\nconst i18nString = i18n.i18n.getLocalizedString.bind(undefined, str_);\n"],
  "mappings": "AAIA;AACA;AAGA;AAEO,yDAAkD,qBAAqB;AAAA,0BACrC,QAAQ;AAAA,EAE/C,SAAe;AAGb,iCAA6B,2BAA2B,KAAK,eAAe,KAAK;AAAA;AAAA,oBAGlD;AAC/B,SAAK;AACL,UAAM,gCAAgC,KAAK,MAAM;AAAA;AAAA,kCAGnB,OAA+E;AAC7G,UAAM,MAAM,SAAS,cAAc;AACnC,QAAI,UAAU,IAAI;AAElB,UAAM,UAAU,MAAM;AACtB,UAAM,SAAS,MAAM,SAAS,YAAY;AAC1C,QAAI,YAAY,MAAM,KAAK,kBACvB,EAAC,UAAU,QAAQ,uBAAuB,eAAe,QAAQ,iBAAiB,UAClF,MAAM;AACV,SAAK,sBAAsB,KAAK,OAAO,SAAS,gBAAgB,MAAM,QAAQ,eAAe;AAC7F,SAAK,sBAAsB,KAAK,OAAO,QAAQ;AAC/C,SAAK,sBAAsB,KAAK,OAAO,QAAQ;AAC/C,SAAK,sBAAsB,KAAK,QAAQ;AACxC,SAAK,sBAAsB,KAAK,QAAQ;AAExC,SAAK,kBAAkB,YAAY;AAAA;AAAA,mCAGJ,QACf;AAChB,UAAM,SAAS,SAAS,cAAc;AACtC,SAAK,kBAAkB,QAAQ,WAAW,UAAU;AACpD,SAAK,kBAAkB,QAAQ,WAAW,UAAU;AACpD,SAAK,kBAAkB,QAAQ,WAAW,UAAU;AACpD,SAAK,kBAAkB,QAAQ,WAAW,UAAU;AACpD,SAAK,kBAAkB,QAAQ,WAAW,UAAU;AACpD,SAAK,kBAAkB,QAAQ,WAAW,UAAU;AAEpD,SAAK,kBAAkB,YAAY;AACnC,QAAI,QAAQ;AACZ,eAAW,oBAAoB,QAAQ;AACrC;AACA,YAAM,+BAA+B;AAAA;AAEvC,SAAK,4BAA4B;AAAA;AAAA;AAIrC,MAAM,YAAY;AAAA,EAIhB,SAAS;AAAA,EAIT,eAAe;AAAA,EAIf,WAAW;AAAA,EAIX,YAAY;AAAA,EAIZ,UAAU;AAAA,EAIV,YAAY;AAAA;AAEd,MAAM,OAAO,KAAK,KAAK,kBAAkB,wDAAwD;AACjG,MAAM,aAAa,KAAK,KAAK,mBAAmB,KAAK,QAAW;",
  "names": []
}
