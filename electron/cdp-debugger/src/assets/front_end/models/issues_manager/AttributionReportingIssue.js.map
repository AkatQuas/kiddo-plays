{
  "version": 3,
  "sources": ["../../../../../../front_end/models/issues_manager/AttributionReportingIssue.ts"],
  "sourcesContent": ["// Copyright 2021 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport type * as SDK from '../../core/sdk/sdk.js';\nimport * as Protocol from '../../generated/protocol.js';\n\nimport {Issue, IssueCategory, IssueKind} from './Issue.js';\nimport type {MarkdownIssueDescription} from './MarkdownIssueDescription.js';\n\nexport const enum IssueCode {\n  PermissionPolicyDisabled = 'AttributionReportingIssue::PermissionPolicyDisabled',\n  AttributionSourceUntrustworthyFrameOrigin = 'AttributionReportingIssue::AttributionSourceUntrustworthyFrameOrigin',\n  AttributionSourceUntrustworthyOrigin = 'AttributionReportingIssue::AttributionSourceUntrustworthyOrigin',\n  AttributionUntrustworthyFrameOrigin = 'AttributionReportingIssue::AttributionUntrustworthyFrameOrigin',\n  AttributionUntrustworthyOrigin = 'AttributionReportingIssue::AttributionUntrustworthyOrigin',\n  InvalidHeader = 'AttributionReportingIssue::InvalidHeader',\n}\n\nfunction getIssueCode(details: Protocol.Audits.AttributionReportingIssueDetails): IssueCode {\n  switch (details.violationType) {\n    case Protocol.Audits.AttributionReportingIssueType.PermissionPolicyDisabled:\n      return IssueCode.PermissionPolicyDisabled;\n    case Protocol.Audits.AttributionReportingIssueType.AttributionSourceUntrustworthyOrigin:\n      return details.frame !== undefined ? IssueCode.AttributionSourceUntrustworthyFrameOrigin :\n                                           IssueCode.AttributionSourceUntrustworthyOrigin;\n    case Protocol.Audits.AttributionReportingIssueType.AttributionUntrustworthyOrigin:\n      return details.frame !== undefined ? IssueCode.AttributionUntrustworthyFrameOrigin :\n                                           IssueCode.AttributionUntrustworthyOrigin;\n    case Protocol.Audits.AttributionReportingIssueType.InvalidHeader:\n      return IssueCode.InvalidHeader;\n  }\n}\n\nexport class AttributionReportingIssue extends Issue<IssueCode> {\n  issueDetails: Readonly<Protocol.Audits.AttributionReportingIssueDetails>;\n\n  constructor(\n      issueDetails: Protocol.Audits.AttributionReportingIssueDetails, issuesModel: SDK.IssuesModel.IssuesModel) {\n    super(getIssueCode(issueDetails), issuesModel);\n    this.issueDetails = issueDetails;\n  }\n\n  getCategory(): IssueCategory {\n    return IssueCategory.AttributionReporting;\n  }\n\n  getDescription(): MarkdownIssueDescription|null {\n    switch (this.code()) {\n      case IssueCode.PermissionPolicyDisabled:\n        return {\n          file: 'arPermissionPolicyDisabled.md',\n          links: [],\n        };\n      case IssueCode.AttributionSourceUntrustworthyFrameOrigin:\n        return {\n          file: 'arAttributionSourceUntrustworthyFrameOrigin.md',\n          links: [],\n        };\n      case IssueCode.AttributionSourceUntrustworthyOrigin:\n        return {\n          file: 'arAttributionSourceUntrustworthyOrigin.md',\n          links: [\n            {\n              link:\n                  'https://developer.chrome.com/docs/privacy-sandbox/attribution-reporting-event-guide/#html-attribute-attributiondestination-required',\n              linkTitle: 'attributiondestination attribute',\n            },\n            {\n              link:\n                  'https://developer.chrome.com/docs/privacy-sandbox/attribution-reporting-event-guide/#html-attribute-attributionreportto',\n              linkTitle: 'attributionreportto attribute',\n            },\n          ],\n        };\n      case IssueCode.AttributionUntrustworthyFrameOrigin:\n        return {\n          file: 'arAttributionUntrustworthyFrameOrigin.md',\n          links: [],\n        };\n      case IssueCode.AttributionUntrustworthyOrigin:\n        return {\n          file: 'arAttributionUntrustworthyOrigin.md',\n          links: [],\n        };\n      case IssueCode.InvalidHeader:\n        return {\n          file: 'arInvalidHeader.md',\n          links: [],\n        };\n    }\n  }\n\n  primaryKey(): string {\n    return JSON.stringify(this.issueDetails);\n  }\n\n  getKind(): IssueKind {\n    return IssueKind.PageError;\n  }\n\n  static fromInspectorIssue(issuesModel: SDK.IssuesModel.IssuesModel, inspectorIssue: Protocol.Audits.InspectorIssue):\n      AttributionReportingIssue[] {\n    const {attributionReportingIssueDetails} = inspectorIssue.details;\n    if (!attributionReportingIssueDetails) {\n      console.warn('Attribution Reporting issue without details received.');\n      return [];\n    }\n    return [new AttributionReportingIssue(attributionReportingIssueDetails, issuesModel)];\n  }\n}\n"],
  "mappings": "AAKA;AAEA;AAGO,WAAW,YAAX,kBAAW,eAAX;AACL,2CAA2B;AAC3B,4DAA4C;AAC5C,uDAAuC;AACvC,sDAAsC;AACtC,iDAAiC;AACjC,gCAAgB;AANA;AAAA;AASlB,sBAAsB,SAAsE;AAC1F,UAAQ,QAAQ;AAAA,SACT,SAAS,OAAO,8BAA8B;AACjD,aAAO;AAAA,SACJ,SAAS,OAAO,8BAA8B;AACjD,aAAO,QAAQ,UAAU,SAAY,yHACA;AAAA,SAClC,SAAS,OAAO,8BAA8B;AACjD,aAAO,QAAQ,UAAU,SAAY,6GACA;AAAA,SAClC,SAAS,OAAO,8BAA8B;AACjD,aAAO;AAAA;AAAA;AAIN,+CAAwC,MAAiB;AAAA,EAC9D;AAAA,EAEA,YACI,cAAgE,aAA0C;AAC5G,UAAM,aAAa,eAAe;AAClC,SAAK,eAAe;AAAA;AAAA,EAGtB,cAA6B;AAC3B,WAAO,cAAc;AAAA;AAAA,EAGvB,iBAAgD;AAC9C,YAAQ,KAAK;AAAA,WACN;AACH,eAAO;AAAA,UACL,MAAM;AAAA,UACN,OAAO;AAAA;AAAA,WAEN;AACH,eAAO;AAAA,UACL,MAAM;AAAA,UACN,OAAO;AAAA;AAAA,WAEN;AACH,eAAO;AAAA,UACL,MAAM;AAAA,UACN,OAAO;AAAA,YACL;AAAA,cACE,MACI;AAAA,cACJ,WAAW;AAAA;AAAA,YAEb;AAAA,cACE,MACI;AAAA,cACJ,WAAW;AAAA;AAAA;AAAA;AAAA,WAId;AACH,eAAO;AAAA,UACL,MAAM;AAAA,UACN,OAAO;AAAA;AAAA,WAEN;AACH,eAAO;AAAA,UACL,MAAM;AAAA,UACN,OAAO;AAAA;AAAA,WAEN;AACH,eAAO;AAAA,UACL,MAAM;AAAA,UACN,OAAO;AAAA;AAAA;AAAA;AAAA,EAKf,aAAqB;AACnB,WAAO,KAAK,UAAU,KAAK;AAAA;AAAA,EAG7B,UAAqB;AACnB,WAAO,UAAU;AAAA;AAAA,SAGZ,mBAAmB,aAA0C,gBACpC;AAC9B,UAAM,EAAC,qCAAoC,eAAe;AAC1D,QAAI,CAAC,kCAAkC;AACrC,cAAQ,KAAK;AACb,aAAO;AAAA;AAET,WAAO,CAAC,IAAI,0BAA0B,kCAAkC;AAAA;AAAA;",
  "names": []
}
